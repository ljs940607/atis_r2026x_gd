define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityModel",["UWA/Core","DS/TreeModel/TreeNodeModel","DS/CfgBaseUX/scripts/CfgColumnManager","UWA/Class/Model","DS/CfgBaseUX/scripts/CfgUXEnvVariables","DS/CfgBaseUX/scripts/CfgUtility","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,i,o,a,n,r,s){return o.extend({columnsCounter:0,_onNodeModelUpdateSubscriptionToken:"",defaults:function(){return{title:"",subtitle:"",content:"",image:"",icon:"",color:"",url:"",idModel:"",jsonAttr:"",evoExp:"",columns:[],treeDocument:null}},registeronNodeUpdateEvent:function(){var e=this;this._onNodeModelUpdateSubscriptionToken=this.get("treeDocument").onNodeModelUpdate((function(t){if(1==Object.keys(t.data.attributes).length&&1==Object.keys(t.data.attributes).at(0).includes("_")){let i=Object.keys(t.data.attributes).at(0),o=t.data.attributes[i];e.undoRegisteronNodeUpdateEvent(),e.updateVariantsSelection(t.data.nodeModel,i,o),e.registeronNodeUpdateEvent()}}))},undoRegisteronNodeUpdateEvent:function(){this.get("treeDocument").unsubscribe(this._onNodeModelUpdateSubscriptionToken)},getXMLExpression:function(e){var t=this.get("columns"),i=this.get("treeDocument");i.prepareUpdate();for(var o=i.getRoots(),a=[],r=0;r<t.length;r++){var s="",l=0;if("tristate"===t[r].typeRepresentation){for(var d=0;d<o.length;d++){var c=o[d].getChildren();if("Exclusive"!=o[d]._options.data.featureType)for(var u=0;u<c.length;u++){var p="";if("undefined"!=(m=c[u]._options.grid[t[r].dataIndex])){var f="",h="";"TXT"==e?(f=n.escapeSpecialCharacters(o[d]._options.data.label),h=n.escapeSpecialCharacters(c[u]._options.data.label)):(f=o[d]._options.data.value,h=c[u]._options.data.value),p='<Feature Type = "ConfigFeature" Name = "'+f+'"><Feature Type = "ConfigFeature" Name = "'+h+'"/></Feature>',l++}"undefined"!=m&&0==m&&(p="<NOT>"+p+"</NOT>"),s+=p}else{var g="",v="";for(p="",u=0;u<c.length;u++){var m;"undefined"!=(m=c[u]._options.grid[t[r].dataIndex])&&(v=v+'<Feature Type = "ConfigFeature" Name = "'+(h="TXT"==e?n.escapeSpecialCharacters(c[u]._options.data.label):c[u]._options.data.value)+'"/>'),0==m&&(g=!0)}""!=v&&(p='<Feature Type = "ConfigFeature" Name = "'+(f="TXT"==e?n.escapeSpecialCharacters(o[d]._options.data.label):o[d]._options.data.value)+'">'+v+"</Feature>",l++),1==g&&(p="<NOT>"+p+"</NOT>"),s+=p}}""!=s&&a.push({xml:s,featureInCondition:l})}}for(var C="",V=0;V<a.length;V++)a[V].featureInCondition>1?C=C+"<AND>"+a[V].xml+"</AND>":C+=a[V].xml;a.length>1&&(C="<OR>"+C+"</OR>");var y="",w="";return w="TXT"==e?n.escapeSpecialCharacters(this.get("title")):this.get("subtitle"),""!=C&&(y='<Context HolderType = "Model" HolderName = "'+w+'">'+C+"</Context>"),i.pushUpdate(),y},updateVariantsSelection:function(e,t,i){if(e&&null!=e.getParent()._options&&e.getParent()._options.children.length>1&&null!=e.getParent()._options.data&&"Exclusive"==e.getParent()._options.data.featureType){console.log("inside updateVariantsSelection");var o=e;this.get("treeDocument").prepareUpdate();let a=o.getParent().getAllDescendants();for(let e=0;e<a.length;e++){let o=a[e]._options.grid[t];if(1==i&&0==o||0==i&&1==o){let i={};i[t]="undefined",a[e].updateOptions({grid:i})}}this.get("treeDocument").pushUpdate()}this.onModelUpdateCallback&&this.onModelUpdateCallback()},deleteColumns:function(e,t){for(var i=[],o=[],a=0;a<t.length;a++)-1==e.indexOf(a)||"string"==t[a].typeRepresentation?o.push(t[a]):i.push(t[a].dataIndex);var n=this.get("treeDocument");n.prepareUpdate();for(var r=n.getAllDescendants(),s=0;s<r.length;s++){var l=r[s],d=l._options.grid;for(a=0;a<i.length;a++)delete d[i[a]];l.updateOptions({grid:d})}n.pushUpdate(),this.set("columns",o)},copyColumns:function(e,t){for(var i=[],o=0;o<e.length;o++)"string"!=t[e[o]].typeRepresentation&&i.push(e[o]);e=i;var a=[],n=[];for(o=0;o<e.length;o++)n.push(t[e[o]].dataIndex),a.push(this.addColumn());for(o=0;o<e.length;o++){var r=this.get("treeDocument");r.prepareUpdate();for(var s=r.getAllDescendants(),l=0;l<s.length;l++){for(var d=s[l],c=d._options.grid,u=0;u<a.length;u++)c[a[o]]=c[n[o]];d.updateOptions({grid:c})}r.pushUpdate()}return a},addRow:function(e){console.log(e),this.undoRegisteronNodeUpdateEvent();var o=i.getColumnIndexes("VariantsAndOptionGroups"),a=this.get("columns"),n=this.get("treeDocument");n.prepareUpdate();for(var r={},s={},l=0;l<a.length;l++)"tree"!=a[l].dataIndex&&(s[a[l].dataIndex]="",r[a[l].dataIndex]="undefined");for(l=0;l<o.length;l++)s[o[l]]="",r[o[l]]="undefined";var d=n.getRoots();if(null==e.items){for(var c=0,u=0;u<d.length;u++)if(d[u]._options.data.value==e.parentReference.value){for(var p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}}),h="-1",g=0;g<e.originalData.feature.options.length;g++){var v=e.originalData.feature.options[g].name;e.value==v&&(h=g)}"-1"!=h&&this.updateAttributes(f,e.originalData.feature.options[h]),d[u].addChild(f),c=1}if(0==c){p=Object.assign({},s);var m=new t({label:e.parentReference.label,grid:p,data:{value:e.parentReference.value,label:e.parentReference.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.self),m.addChild(f),m.expandAll()}}else{p=Object.assign({},s),m=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);for(g=0;g<e.items.length;g++){var C=e.items[g];p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.feature.options[g]),m.addChild(f),m.expandAll()}}n.pushUpdate(),this.registeronNodeUpdateEvent()},addRowWebUX:function(e){console.log(e),this.undoRegisteronNodeUpdateEvent();var o=i.getColumnIndexes("VariantsAndOptionGroups"),a=this.get("columns"),n=this.get("treeDocument");n.prepareUpdate();for(var r={},s={},l=0;l<a.length;l++)"tree"!=a[l].dataIndex&&(s[a[l].dataIndex]="",a[l].dataIndex.includes("_")&&"tristate"===a[l].typeRepresentation?r[a[l].dataIndex]="undefined":r[a[l].dataIndex]="");for(l=0;l<o.length;l++)s[o[l]]="",r[o[l]]="undefined";var d=n.getRoots();if(null==e.children){for(var c=0,u=0;u<d.length;u++)if(d[u]._options.data.value==e._parentNode.value){for(var p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}}),h="-1",g=0;g<e.originalData.feature.options.length;g++){var v=e.originalData.feature.options[g].name;e.value==v&&(h=g)}if("-1"!=h&&this.updateAttributes(f,e.originalData.feature.options[h]),d[u].options&&d[u].options.children){d[u].options.children.map((e=>e.options.data.value)).includes(e.value)||d[u].addChild(f)}c=1}if(0==c){p=Object.assign({},s);var m=new t({label:e._parentNode.label,grid:p,data:{value:e._parentNode.value,label:e._parentNode.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);p=Object.assign({},r),f=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.self),m.addChild(f),m.expandAll()}}else{let i,o=!1;if(d.forEach(((t,a)=>{t._options.data.value===e.value&&(o=!0,i=a)})),!1===o){p=Object.assign({},s),m=new t({label:e.label,grid:p,data:{value:e.value,label:e.label,featureType:e.featureType}});this.updateAttributes(m,e.originalData.feature),n.addRoot(m);for(g=0;g<e.children.length;g++){var C=e.children[g]._options;p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});this.updateAttributes(f,e.originalData.feature.options[g]),m.addChild(f),m.expandAll()}}else if(!0===o){let o=[];d[i]._options.children.forEach((e=>{o.push(e._options.data.value)}));for(g=0;g<e.children.length;g++){C=e.children[g]._options,p=Object.assign({},r);Object.assign({},e).self=C;f=new t({label:C.label,grid:p,data:{value:C.value,label:C.label,featureType:e.featureType}});o.includes(C.value)||(this.updateAttributes(f,e.originalData.feature.options[g]),d[i].addChild(f))}}}n.pushUpdate(),this.registeronNodeUpdateEvent()},updateAttributes:function(e,t){for(var o=e._options.grid,a=i.getColumnIndexes("VariantsAndOptionGroups"),n=0;n<a.length;n++)o[a[n]]=t[a[n]];t.physicalID&&(o.id=t.physicalID),o.typeNLS=t.type_NLS||t.type;let r=t.typeName||t.type;"VariabilityGroup"===r?o.type="Variability Group":"VariabilityOption"===r?o.type="Variability Option":"VariantValue"===r?o.type="Variant Value":r&&(o.type=r),e.updateOptions({grid:o})},clearRows:function(){var e=this.get("treeDocument");e.prepareUpdate(),e.selectAll(),this.removeRows(),e.pushUpdate()},clearColumns:function(){for(var e=this.get("columns"),t=[],i=0;i<e.length;i++)0!=i&&"string"!=e[i].typeRepresentation&&i!=e.length-1||t.push(e[i]);this.set("columns",t)},removeRows:function(){this.undoRegisteronNodeUpdateEvent(),this.deletedRowValues=[],this.deletedRowPhysicalId=[];var e=this.get("treeDocument"),t=e.getSelectedNodes(),i=[];e.prepareUpdate();for(var o=0;o<t.length;o++){if(1==t[o].hasChildren()){t[o].remove(),this.deletedRowValues.push(t[o]._options.data.value),t[o].options&&t[o].options.data&&t[o].options.data.self&&t[o].options.data.self.physicalID&&this.deletedRowPhysicalId.push(t[o].options.data.self.physicalID);let e=t[o].options.children.map((e=>{if(e.options.data&&e.options.data.self&&e.options.data.self.physicalID)return e.options.data.self.physicalID}));this.deletedRowPhysicalId=this.deletedRowPhysicalId.concat(e)}}e.pushUpdate(),t=e.getSelectedNodes(),e.prepareUpdate();for(o=0;o<t.length;o++){0==t[o].hasChildren()&&(i.push(t[o].getParent()),t[o].remove(),this.deletedRowValues.push(t[o]._options.data.value),t[o].options.data&&t[o].options.data.self&&t[o].options.data.self.physicalID&&this.deletedRowPhysicalId.push(t[o].options.data.self.physicalID),i.length>0&&i[0].options.data.value&&this.deletedRowValues.push(i[0].options.data.value))}for(o=0;o<i.length;o++){0==i[o].hasChildren()&&(i[o].remove(),this.deletedRowValues.push(i[o]._options.data.value),i[o]._options.data.self&&i[o]._options.data.self.physicalID&&this.deletedRowPhysicalId.push(i[o]._options.data.self.physicalID))}e.pushUpdate(),this.registeronNodeUpdateEvent()},addColumn:function(){this.undoRegisteronNodeUpdateEvent();var e=this.get("columns"),t=this.getColumnDefination(),i=t.dataIndex="_"+this.columnsCounter;this.columnsCounter++,t.text=s.Combination+this.columnsCounter,e.push(t);var o=this.get("treeDocument");o.prepareUpdate();for(var a=o.getAllDescendants(),n=0;n<a.length;n++){var r={};r[i]="",1!=a[n].hasChildren()?(r[i]="undefined",a[n].updateOptions({grid:r})):a[n].updateOptions({grid:r})}return o.pushUpdate(),this.registeronNodeUpdateEvent(),i},getSelectedFeatureOptions:function(){for(var e=[],t=this.get("treeDocument").getAllDescendants(),i=0;i<t.length;i++)e.push(t[i]._options.data.value);let o=a.getCfgUXEnvVariables().isWebUXAutocompleteEnabled,n=this.get("treeDocumentVariantDictionary");if(1==o&&n){n.getAllDescendants().forEach((t=>{if(t.options&&t.options.children){if(!1===t.options.children.map((e=>e.options.grid.name)).every((t=>e.includes(t)))){let i=e.indexOf(t.options.grid.name);i>=0&&e.splice(i,1)}}}))}return e},getDeletedFeatureOptions:function(){return this.deletedRowValues?this.deletedRowValues:void 0},getColumnDefination:function(){return{dataIndex:"",typeRepresentation:"tristate",editionPolicy:"EditionInPlace",alwaysVisibleFlag:"true",width:"28",minWidth:"28",resizableFlag:!0,sortableFlag:!1,groupableFlag:!1,pinned:"right"}},ConvertJsonEffectivitytoColumns:function(e,t){var i={text:s.Title,dataIndex:"tree",typeRepresentation:"string",alwaysVisibleFlag:"true",width:"220",minWidth:"220"},o=[];o.push(i),o=o.concat(t);for(var a=0;a<e.Combinations.length;a++){var n=this.getColumnDefination();n.dataIndex="_"+this.columnsCounter,this.columnsCounter++,n.text=s.Combination+this.columnsCounter,o.push(n)}return o}})})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantAutocomplete",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/CfgBaseUX/scripts/CfgUtility","DS/UIKIT/Autocomplete","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,i,o,a){var n={initialiseAutocomplete:function(e){this.options=e,e.parent.autocompleteContainer.setHTML(""),this.autocompleteHierarchicalInput=new o({multiSelect:!1,showSuggestsOnFocus:!1,placeholder:a.Auto_Place_Holder,disabled:!0,allowFreeInput:!0,events:{onSelect:function(e,t){event.stopPropagation(),n.options.onSelectCallback(e),this.onUnselect(e)},onUnselect:function(e,t){}}});var t=UWA.createElement("div",{class:"CfgAutoPickContainer"});t.setStyles({position:"relative",marginRight:"15px",display:"flex"}),this.autocompleteHierarchicalInput.inject(t),t.inject(e.parent.autocompleteContainer),e.parent.autocompleteContainer.getElement(".autocomplete").setStyle("width","100%"),e.parent.autocompleteContainer.getElement(".autocomplete-reset").setStyles({right:"30px",top:"6px"});var i=UWA.createElement("span",{class:"fonticon fonticon-1x fonticon-search"});i.setStyles({"font-size":"14px !important",position:"absolute",right:"2px",bottom:"10px","margin-top":"5px"});var r=UWA.createElement("div",{class:"imgSearchContainer1",id:"searchIconCont"});return r.style.opacity="0.5",r.addClassName("imgFocusIdenty"),r.addContent(i),i.inject(r),r.addEventListener("click",(function(){n.autocompleteHierarchicalInput.showAll()})),r.inject(t),n},setDisable:function(e){this.autocompleteHierarchicalInput.getItems().forEach((function(t){n.autocompleteHierarchicalInput.enableItem(t.value),1==e.includes(t.value)&&n.autocompleteHierarchicalInput.disableItem(t.value)}))},drawDictionary:function(e){if(0==e.length)i.showwarning(a.No_Conf_Features_Title,"warning");else{for(var t={name:"Objects",items:[]},o=0;o<e.length;o++)if(0!=e[o].options.length){var r={};r.featureType=e[o].selectionType,r.label=e[o].displayName,r.value=e[o].name,r.items=[],r.originalData={feature:e[o],self:e[o]};for(var s=0;s<e[o].options.length;s++){var l={};l.featureType=e[o].selectionType,l.label=e[o].options[s].displayName,l.value=e[o].options[s].name,l.parentSelectionType=e[o].selectionType,l.selection=e[o].options[s].selection,l.originalData={feature:e[o],self:e[o].options[s]},r.items.push(l)}t.items.push(r)}this.autocompleteHierarchicalInput.addDataset(t),this.autocompleteHierarchicalInput.getItems().forEach((function(e){n.autocompleteHierarchicalInput.enableItem(e.value)})),n.autocompleteHierarchicalInput.setDisabled(!1)}}};return n})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",["i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e){var t=Object.create(null);return t.toolbar=null,t.writetoolbarDefination=function(){var t={entries:[{id:"ID_SEARCHFEATUREOPTION",dataElements:{typeRepresentation:"string",value:"",label:"",visibleFlag:!1,tooltip:e.CFG_Search_Features,placeholder:e.CFG_Search_Features,overflowPriority:"none",displayLabel:!0},position:"far",children:[]},{id:"ID_Plus",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Add_Col,disabled:!1,icon:{iconName:"plus",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onPlusClick"}},position:"far",children:[]},{id:"ID_Copy",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Clone_Col,disabled:!0,icon:{iconName:"duplicate",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onCopyClick"}},position:"far",children:[]},{id:"ID_Delete",dataElements:{typeRepresentation:"functionIcon",tooltip:e.Del_Col,disabled:!0,icon:{iconName:"trash",fontIconFamily:1},category:"Touch",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onDeleteClick"}},position:"far",children:[]},{id:"ID_SwitchView",dataElements:{typeRepresentation:"functionIcon",tooltip:e.CFG_HorizontalSwitchView,disabled:!0,visibleFlag:!0,icon:{iconName:"table",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onSwitchViewClick"}},position:"far",children:[]},{id:"ID_Dictionary",dataElements:{typeRepresentation:"functionIcon",tooltip:e.DictionaryHeader,disabled:!1,icon:{iconName:"book-open",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onShowDictionaryClick"}},position:"far",children:[]},{id:"ID_ColumnManager",dataElements:{typeRepresentation:"functionIcon",tooltip:e.ColumnPropertiesManagerHeader,disabled:!1,visibleFlag:!1,icon:{iconName:"cog",fontIconFamily:1},category:"TouchNext",action:{module:"DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar",func:"onUserSettingsClick"}},position:"far",children:[]}]};return JSON.stringify(t)},t.onPlusClick=function(e){e._event="ID_PLUS",t.onToolbarClickCallback(e)},t.onCopyClick=function(e){e._event="ID_COPY",t.onToolbarClickCallback(e)},t.onClearClick=function(e){e._event="ID_CLEAR",t.onToolbarClickCallback(e)},t.onDeleteClick=function(e){e._event="ID_DELETE",t.onToolbarClickCallback(e)},t.onShowDictionaryClick=function(e){e._event="ID_DICTIONARY",t.onToolbarClickCallback(e)},t.onSwitchViewClick=function(e){e._event="ID_HORIZONTALVIEW",t.onToolbarClickCallback(e)},t.onUserSettingsClick=function(e){e._event="ID_USERSETTINGS",e.viewId="effectivityView",t.onToolbarClickCallback(e)},t.setToolbarState=function(e){if(e)for(var i=0;i<e.length;i++){var o=e[i];t.toolbar.updateNodeModel(o.IdValue,{disabled:o.StateValue})}},t})),define("DS/CfgVariantEffectivityEditor/scripts/CfgTweakerVerticalTristate",["UWA/Core","DS/Tweakers/TweakerBase","DS/Utilities/Dom","DS/Utilities/Utils","DS/Core/PointerEvents"],(function(e,t,i,o,a){"use strict";var n=t.inherit({name:"TweakerTristate",publishedProperties:{value:{defaultValue:!1,type:"boolean",advancedSetter:!0},valueType:{defaultValue:"boolean",type:"string"},displayStyle:{defaultValue:"checkbox",type:"string"},minValue:{defaultValue:"",type:"string"}},computeTweakerContentLength:function(){return this._getCurrentTouchMode()?19:14},_upgradeValue:function(e){return"1"===e||1===e||"true"===e||!0===e||"0"!==e&&0!==e&&"false"!==e&&!1!==e&&(""==e?"":"undefined")}}),r=function(e,i){t.prototype.baseViewModule.call(this,e,i)};o.applyMixin(r,t.prototype.baseViewModule);var s=function(e,t){r.call(this,e,t)};o.applyMixin(s,r),s.prototype.buildView=function(){if(this._tweaker.elements.container){var t,i=this._options.viewOptions||{};i.type=this._options.viewOptions.displayStyle,i.touchMode=this._tweaker._getCurrentTouchMode(),i.fireOnlyFromUIInteractionFlag=!0,this._view=new e.Element("div"),this.icon=new e.Element("div"),this.icon.inject(this._view),this.icon.setStyles({height:"100%",width:"100%"}),"undefined"===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon":!1===this._tweaker.value&&(t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg notIcon"),this.icon.addClassName(t),this.setValue(this._tweaker.value)}},s.prototype.handleEvents=function(){var e=this._view,t=this.icon,o=this._tweaker;i.addEventOnElement(o,e,a.POINTERHIT,(function(e){e.stopPropagation(),t.className="";var i="";!1===o.value||!0===o.value?(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon",o.value="undefined"):"undefined"===o.value&&(o.value=!0,i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon"),t.addClassName(i)}))},s.prototype.setValue=function(e,t){if(this.icon){var i="";"undefined"===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg checkIcon":!1===this._tweaker.value&&(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg notIcon"),this.icon.className="",this.icon.addClassName(i)}},s.prototype.setTouchMode=function(e,t){this.icon&&(this.icon.touchMode=e)};var l=function(e,t){r.call(this,e,t)};return o.applyMixin(l,r),l.prototype.buildView=function(){var t;this._tweaker.elements.container&&(this._view=new e.Element("span"),"undefined"===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg ":!1===this._tweaker.value&&(t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg "),this._view.addClassName(t),this.setValue(this._tweaker.value),this.setTouchMode(this._tweaker._getCurrentTouchMode()))},l.prototype.setValue=function(e,t){if(this._view){var i="";"undefined"===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-checkbox-off wux-ui-3ds-lg unselectedIcon":!0===this._tweaker.value?i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check wux-ui-3ds-lg ":!1===this._tweaker.value&&(i="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong wux-ui-3ds-lg "),this._view.className="",this._view.addClassName(i)}},l.prototype.setTouchMode=function(e,t){this._view&&(this._tweaker.readOnly?this._view.style.paddingLeft=e?"14px":"7px":this._view.touchMode=e)},n.prototype.baseViewModule=r,n.prototype.VIEW_MODULES={switch:{classObject:s,options:{viewOptions:{displayStyle:"switch"}}},readOnly:{classObject:l,options:{viewOptions:{displayStyle:"switch"}}},checkbox:{classObject:s,options:{viewOptions:{displayStyle:"checkbox"}}}},n.prototype.registerViewModule=function(e,t){},n})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantWUXAutocomplete",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,i,o,a){var n={model:null,myAutoComplete:null,selectedist:[],initialiseAutocomplete:function(e){this.options=e,e.parent.autocompleteContainer.setHTML("");return this.createModel([]),this.createAutoComplete(),this.myAutoComplete.inject(e.parent.autocompleteContainer),this.selectedist=[],n},enableAutocompleteItems:function(e,t){if(this.selectedist=[...e],this.itemsDeleted=t,this.myAutoComplete&&this.myAutoComplete._dataGridView){this.myAutoComplete.value=void 0;let e=this.myAutoComplete._dataGridView.getTreeDocument();e.prepareUpdate(),e.getAllDescendants().forEach((e=>{this.itemsDeleted&&this.itemsDeleted.includes(e._options.value)&&(e._isHighlighted=!1,e._isSelected=!1,e._options.children&&e._options.children.forEach((e=>{e._isHighlighted=!1,e._isSelected=!1})))})),e.pushUpdate(),model.expandAll()}},drawDictionary:function(e,t){let i=e,n=!0;0==i.length?o.showwarning(a.No_Conf_Features_Title,"warning"):n=!1,t.parent.autocompleteContainer.setHTML(""),this.createModel(i),this.myAutoComplete.elementsTree=model,this.myAutoComplete.disabled=n,this.myAutoComplete.inject(t.parent.autocompleteContainer)},createNode:function(e,i,o){return new t({label:e.displayName,value:e.name,icon:i,featureType:e.selectionType,originalData:o,grid:{tags:e.displayName+e.name}})},createModel:function(t){model=new e({shouldBeSelected:function(e){return(!e||!0!==e._isSelected)&&(!e||!n.selectedist.includes(e.options.value))}}),model.prepareUpdate();const i=enoviaServerFilterWidget.baseURL+"/snresources/images/icons/large/I_Variant_Thumbnail.png",o=enoviaServerFilterWidget.baseURL+"/snresources/images/icons/large/I_VariantValue_Thumbnail.png",a=enoviaServerFilterWidget.baseURL+"/snresources/images/icons/large/I_VariabilityOption_Thumbnail.png",r=enoviaServerFilterWidget.baseURL+"/snresources/images/icons/large/I_VariabilityGroup_Thumbnail.png";for(var s=0;s<t.length;s++){let e,n,c={feature:t[s],self:t[s]};"Variant"===t[s].typeName?e=i:"VariabilityGroup"!==t[s].typeName&&"Variability Group"!==t[s].typeName||(e=r);let u=this.createNode(t[s],e,c);model.addRoot(u);for(var l=0;l<t[s].options.length;l++){let e={feature:t[s],self:t[s].options[l]};"VariantValue"===t[s].options[l].typeName||"Variant Value"===t[s].options[l].typeName?n=o:"VariabilityOption"!==t[s].options[l].typeName&&"Variability Option"!==t[s].options[l].typeName||(n=a);var d=this.createNode(t[s].options[l],n,e);u.addChild(d)}}model.expandAll(),model.pushUpdate()},createAutoComplete:function(){this.myAutoComplete=new i({elementsTree:model,allowFreeInputFlag:!1,multiSearchMode:!1,disabled:!0,filterCB:function(e){this.filterItems(e,{property:"tags"})},defaultFilterOptions:{filterId:"string",filterOptions:{keepChildren:!0}}}),this.myAutoComplete.addEventListener("change",(function(e){var t=null;if(e.dsModel.selectedItems){t=e.dsModel.selectedItems.options;if(e.dsModel.selectedItems._isHighlighted=!0,!t.children){n.selectedist.push(t.value);let i={};i=e.dsModel.selectedItems.options,i._parentNode=e.dsModel.selectedItems._parentNode.options,n.options.onSelectCallback(i)}t.children&&(t.children.forEach((e=>{n.selectedist.push(e.options.value),e._isHighlighted=!0})),n.options.onSelectCallback(t))}document.querySelector(".CfgBodyContainer #containerAuto >div >div >input").value="",model.expandAll()})),this.myAutoComplete.addEventListener("show",(function(e){let t=e.dsModel._dataGridView.getTreeDocument();t.prepareUpdate(),t.getAllDescendants().forEach((e=>{n.selectedist.includes(e._options.value)&&(e._isHighlighted=!0)})),t.pushUpdate(),model.expandAll()}))}};return n})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridView",["UWA/Class/View","DS/DataGridView/DataGridView","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar","DS/Core/PointerEvents","DS/CfgBaseUX/scripts/CfgUtility","DS/Selection/XSO","DS/CfgBaseUX/scripts/CfgUserSettings","DS/CfgBaseUX/scripts/CfgUXEnvVariables","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,i,o,a,n,r,s,l){return e.extend({toolbar:null,processedColumns:null,selectedColumnsIndexes:[],init:function(e){this._parent(e)},render:function(){this.columnsDeepCloned=this.options.columns,this.updateColumnSelectionEventsPrototype(),this.selectedColumnsIndexes=[],this.VariantGridView=new t({treeDocument:this.options.treeDocument,columns:this.columnsDeepCloned,selectionMode:"cell",touchMode:this.options.touchMode,showSelectionCheckBoxesFlag:!0,defaultColumnDef:{width:"auto",typeRepresentation:"string",editableFlag:!0,resizableFlag:!0,sortableFlag:!1,editionPolicy:""},identifier:"edit_variant_effectivityView"});return this.VariantGridView.getTypeRepresentationFactory().registerTypeTemplates({tristatetemplate:{path:"DS/CfgVariantEffectivityEditor/scripts/CfgTweakerVerticalTristate",options:{}}}),this.VariantGridView.getTypeRepresentationFactory().registerTypeRepresentations({tristate:{stdTemplate:"tristatetemplate"}}),this.VariantGridView.showEditableFeedbackFlag=!1,this.VariantGridView.layout.rowsHeader=!0,this.VariantGridView.showRowIndexFlag=!1,this.VariantGridView.columnSelection="multiple",this.VariantGridView.showColumnBorderFlag=!0,this.VariantGridView.placeholder=l.No_Eff_IconMsg,i.toolbar=this.VariantGridView.setToolbar(i.writetoolbarDefination()),this.toolbar=i.toolbar,i.onToolbarClickCallback=this.options.onToolbarClickCallback,this.registerUpdateToolbarCommandStatesEvent(),this.registerToolbarSearchEvents(),this.buildContextualMenu(),this},refreshColumns:function(e,t,i){if(i){let e=this.VariantGridView.columns.filter((e=>t.includes(e.dataIndex)));e.length>0&&e.forEach((e=>this.VariantGridView.removeColumnOrGroup(e)))}else if(t){e.filter((e=>t.includes(e.dataIndex))).forEach((e=>{this.VariantGridView.addColumnOrGroup(e)}))}},registerUpdateToolbarCommandStatesEvent:function(){var e=this;e.setAddToolBarState(!1),this.VariantGridView.treeDocument.getXSO().onPostAdd((function(t){var o=[{IdValue:"ID_Delete",StateValue:!1}];i.setToolbarState(o),e.setAddToolBarState(!1)})),this.VariantGridView.treeDocument.getXSO().onPostRemove((function(t){if(e.VariantGridView.treeDocument.getXSO().isEmpty()&&e.VariantGridView._columnsXSO.isEmpty()){var o=[{IdValue:"ID_Delete",StateValue:!0}];i.setToolbarState(o)}}))},setDeleteToolBarState:function(){},setAddToolBarState:function(e){var t;t={IdValue:"ID_Plus",StateValue:e},i.setToolbarState([t])},isValidNotMenuCell:function(e){if(!0===e.cellInfos.cellModel||!1===e.cellInfos.cellModel||"undefined"===e.cellInfos.cellModel)return!0},setCellValues:function(e,t){var i=this.options.treeDocument.getAllDescendants()[e.cellInfos.rowID];this.options.treeDocument.prepareUpdate();var o,a=i._options.grid,n=[];for(var r in a)a.hasOwnProperty(r)&&n.push(r);o=this.VariantGridView.layout.getLeafColumns().map((e=>e.dataIndex))[e.cellInfos.columnID];var s=i.getParents()[0];if("Exclusive"==s._options.data.featureType&&"undefined"!=t){for(var l=s.getAllDescendants(),d="undefined",c=0;c<l.length;c++)"undefined"!=l[c]._options.grid[o]&&(d=l[c]._options.grid[o]);if(t!=d)for(c=0;c<l.length;c++){var u;(u={})[o]="undefined",l[c].updateOptions({grid:u})}}(u={})[o]=t,i.updateOptions({grid:u}),this.options.treeDocument.pushUpdate()},buildCellSelectionContextualMenu:function(e){var t=this,i=[];return i.push({type:"PushItem",title:l.Menu_Title_Reject,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,!1)},context:{id:"NOT"}}},{type:"PushItem",title:l.Menu_Title_Select,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,!0)},context:{id:"Select"}}},{type:"PushItem",title:l.Menu_Title_Deselect,fonticon:"",state:"",action:{callback:function(i){i&&i.context&&i.context.id&&t.setCellValues(e,"undefined")},context:{id:"Unselect"}}}),i},buildContextualMenu:function(){var e=this;this.VariantGridView.onContextualEvent=function(t){if(1==e.isValidNotMenuCell(t))return e.buildCellSelectionContextualMenu(t);var i=[];if(t&&t.collectionView){let e={pin:!1,firstColumnsVisibility:!1,columnsManagement:!1,sizeColumnToFit:!0,insertRow:!1};i=t.collectionView.buildDefaultContextualMenu(t,e)}return i}},registerToolbarSearchEvents:function(){if(void 0!==this.toolbar){var e=this;this.toolbar.addEventListener("liveChange",(function(t){if(1==t.dsModel._properties.value.dirty){var i=r.UserSettings.effectivityView_VariantsAndOptionGroups;e.options.treeDocument.prepareUpdate(),e.options.treeDocument.getAllDescendants().forEach((function(e){e.show()})),e.options.treeDocument.getRoots().forEach((function(e){e.expandAll()}));var o=t.dsModel._properties.value.value;if(""==o)return void e.options.treeDocument.pushUpdate();for(var a=e.options.treeDocument.getRoots(),n=0;n<a.length;n++){var s=a[n],l=s.getAllDescendants();if(!e.isFeatureSearchCriteria(s,o,i)){for(var d=0,c=0;c<l.length;c++)e.isOptionSearchCriteria(l[c],o,i)&&(l[c].hide(),d++);d==l.length&&s.hide()}}}e.options.treeDocument.pushUpdate()}))}},isFeatureSearchCriteria:function(e,t,i){return-1!=e._options.label.toUpperCase().indexOf(t.toUpperCase())||-1!=e._options.grid.name.toUpperCase().indexOf(t.toUpperCase())||-1!=e._options.grid.type.toUpperCase().indexOf(t.toUpperCase())&&1==i.type||-1!=e._options.grid.description.toUpperCase().indexOf(t.toUpperCase())&&1==i.description},isOptionSearchCriteria:function(e,t,i){var o=!1,a=!1,n=!1,r=!1;return-1==e._options.label.toUpperCase().indexOf(t.toUpperCase())&&(o=!0),-1==e._options.grid.name.toUpperCase().indexOf(t.toUpperCase())&&(a=!0),-1==e._options.grid.type.toUpperCase().indexOf(t.toUpperCase())&&(n=!0),-1==e._options.grid.description.toUpperCase().indexOf(t.toUpperCase())&&(r=!0),0==n&&0==i.type&&(n=!0),0==r&&0==i.description&&(r=!0),o&&a&&n&&r},updateColumnSelectionEventsPrototype:function(){var e=this;t.prototype._applyColumnSelection=function(){if(this.getContent().setAttribute("column-selection",this.columnSelection),"none"===this.columnSelection||this._columnsXSO)"none"===this.columnSelection&&this._columnsXSO&&this._columnsXSO.empty();else{var t=this;this._columnsXSO=new n({useUniqueID:!0,getElementID:this.getXSOColumnID}),this._columnsXSO.onPostAdd((function(o){var a=0;if(o.forEach((function(i){a=i,-1==e.selectedColumnsIndexes.indexOf(a)&&e.selectedColumnsIndexes.push(a),t.updateRenderedColumn(a,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0}),t._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})})),-1!=e.selectedColumnsIndexes.indexOf(e.VariantGridView.layout.getLeafColumns().length-1)){var n={_event:"ID_PLUS"};i.onToolbarClickCallback(n)}var r=[{IdValue:"ID_Delete",StateValue:!1}];i.setToolbarState(r);r=[{IdValue:"ID_Copy",StateValue:!1}];i.setToolbarState(r)})),this._columnsXSO.onPostRemove((function(o){if(o.forEach((function(o){var a=o,n=e.selectedColumnsIndexes.indexOf(a);if(-1!==n&&e.selectedColumnsIndexes.splice(n,1),t.updateRenderedColumn(a,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0}),t._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),!t._columnsXSO.isEmpty()){var r=[{IdValue:"ID_Copy",StateValue:!1}];i.setToolbarState(r)}})),e.VariantGridView.treeDocument.getXSO().isEmpty()&&t._columnsXSO.isEmpty()){var a=[{IdValue:"ID_Delete",StateValue:!0}];i.setToolbarState(a)}if(t._columnsXSO.isEmpty()){a=[{IdValue:"ID_Copy",StateValue:!0}];i.setToolbarState(a)}}))}this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})}}})})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityCollection",["UWA/Class/Collection","DS/WebappsUtils/WebappsUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityModel","DS/CfgBaseUX/scripts/CfgColumnManager","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,i,o,a,n,r,s,l,d){return e.extend({model:s,initialiseCollectionOptions:function(e){this.options=e,0==this.options.hasEffectivity?console.log("Has No Effectivity, Models would be initilized to default values with Model Name and Empty Combinations"):(this.options.finalJson=r.VariantXMLToJSONConverter(this.options.varEffXML),this.options.descJson=r.VariantDescXMLtoJSONConverter(this.options.varEffXML)),this.options.evoEffXML&&(this.options.evoExpJson=r.EvolutionXMLtoJSONforFilterVariant(this.options.evoEffXML))},init:function(e){this._parent(e)},getEvoExpVal:function(e){Array.isArray(e)&&(e=e[0]);var t="";if(this.options.evoEffXML)for(var i=0;i<this.options.evoExpJson.contextsFilterXML.length;i++)if(this.options.evoExpJson.contextsFilterXML[i].name==e){t=this.options.evoExpJson.contextsFilterXML[i].expression;break}return t},getJsonAttrValue:function(e,t){Array.isArray(e)&&(e=e[0]),Array.isArray(t)&&(t=t[0]);var i={name:e,displayValue:t,Combinations:[]};if(1==this.options.hasEffectivity)for(var o=0;o<this.options.finalJson.length;o++){var a=JSON.parse(this.options.finalJson[o]);if(a.displayValue=t,a.name==e){a.Combinations.length>0&&(i=a=n.fillVariantDictionaryWithDisplayName(a,this.options.descJson));break}}return i},initialiseModels:function(e){var t=this.options.contextData,i=enoviaServerFilterWidget.baseURL,o="",a="";null!=i&&"undefined"!=i&&""!=i&&(o=enoviaServerFilterWidget.baseURL+"/common/images/I_Model_Thumbnail.png",a=enoviaServerFilterWidget.baseURL+"/common/images/iconSmallModel.png");for(var r=0;r<=t.length-1;r++){var c=t[r],u=c.physicalID,p=o;null!=c.preview_url&&"undefined"!=c.preview_url&&""!=c.preview_url&&(p=c.preview_url);var f=n.getAttributeValue(c.data,"Marketing Name");f=n.escapeforJsonParser(f);var h=n.getAttributeValue(c.basicData,"name"),g="<span style='color:#77797c'>"+(d.Maturity+":"+n.getAttributeValue(c.basicData,"current"))+"</span><br><span style='color:#77797c'>"+(d.Owner+":"+n.getAttributeValue(c.basicData,"owner"))+"</span>",v=this.getJsonAttrValue(h,f),m=this.getEvoExpVal(h),C='{ "id": "'+u+'", "title": "'+f+'", "subtitle": "'+h+'", "content": "'+g+'","image": "'+p+'", "icon": "'+a+'", "color": "", "url": "", "idModel": "'+u+'" ,"jsonAttr":""}',V=JSON.parse(C);V.jsonAttr=JSON.stringify(v),V.evoExp=m;var y=new s;this.add(y),y.set(V);var w=l.getTypeColumns("VariantsAndOptionGroups"),E=y.ConvertJsonEffectivitytoColumns(v,w);y.onModelUpdateCallback=e,y.set("columns",E),y.set("treeDocument",this.ConvertJsonEffectivitytoTreeDocument(v,E)),y.registeronNodeUpdateEvent(),y.addColumn()}},getModelswithEffExpression:function(){for(var e=this.length,t=[],i=0;i<e;i++){var o=this.at(i);""!=o.getXMLExpression()&&t.push(o.get("id"))}return t},getGlobalXMLExpression:function(e){for(var t=this.length,i="",o="",a=0;a<t;a++){o+=this.at(a).getXMLExpression(e)}return this.length>1?""!=o&&(i="<MultiContextView>"+o+"</MultiContextView>"):i=o,""!=i&&(i='<CfgEffectivityExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgEffectivityExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><Expression>'+i+"</Expression></CfgEffectivityExpression>"),i},ConvertJsonEffectivitytoTreeDocument:function(e,t){for(var n={},r={},s=0;s<t.length;s++)"tree"!=t[s].dataIndex&&(n[t[s].dataIndex]="",r[t[s].dataIndex]="undefined","string"==t[s].typeRepresentation&&(r[t[s].dataIndex]=""));var l=new a,d=new i({dataModelSet:l});d.prepareUpdate();for(var c=new Object,u=0;u<e.Combinations.length;u++)for(var p=e.Combinations[u].Combination,f=0;f<p.length;f++){null==c[p[f].Feature.value]&&(c[p[f].Feature.value]=p[f].Feature,c[p[f].Feature.value].Options=new Object);for(var h=0;h<p[f].Options.length;h++)null==c[p[f].Feature.value].Options[p[f].Options[h].Option.value]&&(c[p[f].Feature.value].Options[p[f].Options[h].Option.value]=p[f].Options[h].Option,c[p[f].Feature.value].Options[p[f].Options[h].Option.value].grid={...r}),"S"==p[f].Options[h].Option.selection?c[p[f].Feature.value].Options[p[f].Options[h].Option.value].grid["_"+u]=!0:"R"==p[f].Options[h].Option.selection&&(c[p[f].Feature.value].Options[p[f].Options[h].Option.value].grid["_"+u]=!1)}for(var g in c)if(c.hasOwnProperty(g)){var v=c[g],m=UWA.clone(n),C=new o({label:v.label,grid:m,data:c[g]});for(var V in d.addRoot(C),c[g].Options)if(c[g].Options.hasOwnProperty(V)){var y=c[g].Options[V],w=(m=UWA.clone(y.grid),new o({label:y.label,grid:m,data:y}));C.addChild(w)}}return d.expandAll(),d.pushUpdate(),d}})})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","UWA/Class/View","DS/Handlebars/Handlebars","DS/CfgBaseUX/scripts/CfgSliderView","DS/CfgBaseUX/scripts/CfgUtility","WebappsUtils/WebappsUtils","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridView","DS/CfgVariantEffectivityEditor/scripts/CfgVariantAutocomplete","DS/CfgVariantEffectivityEditor/scripts/CfgVariantWUXAutocomplete","DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgFeatureOptionsView","DS/Controls/Toggle","text!DS/CfgVariantEffectivityEditor/scripts/CfgVariantDialogLayout.html","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEditorDataGridViewToolbar","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityCollection","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorModelsCollection","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorServices","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEditorDataGridView","DS/CfgMassVariantEffectivityEditor/scripts/CfgMassVariantEffectivityEditorModelSelector","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgEffectivityExpressionContainer","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgColumnManager","DS/CfgBaseUX/scripts/CfgUserSettings","DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgUXEnvVariables","DS/CfgBaseUX/scripts/CfgCustomAttributeUtility","DS/ENOCustomAttributeUtils/scripts/CustomAttributeUtils","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor"],(function(e,t,o,a,n,r,s,l,d,c,u,p,f,h,g,v,m,C,V,y,w,E,b,D,_,I,S,T,x,O,A,M,N,U,F){var G=n.compile(g),k={currentSelectedModelId:null,isMultipleModelsAttached:!1,resetDialogShow:!1,checkFlag:!0,isModified:!1,probesData:[],init:function(e){return k.probesData=[],this.options=e,k.checkFlag=!0,k.isModified=!1,k.isWebUXAutocompleteEnabled=A.getCfgUXEnvVariables().isWebUXAutocompleteEnabled,k.cfgUseGetAvailableFeaturesOptions=A.getCfgUXEnvVariables().CFGUseGetAvailableFeaturesOptions,this.readServiceLimit=A.getCfgUXEnvVariables().readServiceLimit,this.attachedModels=this.processAttachedModels(e.contextData),1==this.attachedModels.length?this.isMultipleModelsAttached=!1:this.isMultipleModelsAttached=!0,this.buildSliderView(),this.sliderView._leftPanel.getElement(".gridViewContainer").setHTML(G(F)),this.sliderView._leftPanel.getElement(".modalBodyWithoutFooter").setAttribute("style","height: 100% !important"),"Dashboard"!=this.options.mode&&(this.sliderView._leftPanel.setStyle("height","calc(100% - 68px)"),this.sliderView._rightPanel.setStyle("height","calc(100% - 68px)")),E.isReadOnlyMode=!1,this.initialiseContainers(),this.initialiseModelSelector(),this.initialiseVerticalCollection(),"Native"!=window.enoviaServerFilterWidget.mode&&"EXTERNAL"!=window.enoviaServerFilterWidget.mode&&this.initialiseHorizontalCollection(),this.currentSelectedModelId=this.cfgCollectionVertical.at(0).get("id"),this.initialiseUI(this.cfgCollectionVertical.at(0)),this.initialiseExpandCollpaseEvents(),!1===this.cfgUseGetAvailableFeaturesOptions&&this.loadNextModelsDictionaryAsyncronously(this.attachedModels,e),k},loadNextModelsDictionaryAsyncronously:function(e,t){for(var i=[],o=1;o<e.length;o++){var a="",n=k.cfgCollectionVertical.at(o),r=k.cfgCollectionVertical.at(o).get("evoExp");""!==r&&(a={evolutionExpression:JSON.stringify({filterExpression:S.getValidXmlWithoutDescId(r)})}),i.push(s.getLegacyCfgDico(n.get("idModel"),a))}Promise.all(i).then((function(e){for(var t=0;t<e.length;t++){for(var i=[],o=k.cfgCollectionVertical.at(t+1),a=0;a<e[t].features.length;a++){var n=e[t].features[a];"Preliminary"!==n.current&&"Obsolete"!==n.current&&i.push(n)}e[t].features=i,p.addDictionaryByCriteria(o.get("idModel"),e[t],"features");var r=k.processDictionary(e[t]),s=k.createDictionaryTreeDocument(r);o.set("treeDocumentVariantDictionary",s),k.initialiseFeatureTypeForEffectivityOptions(o,e[t]),k.isModified=!1}}),(function(){s.showwarning(F.Dictionary_Error,"error")}))},buildSliderView:function(){var e={isReadOnlyMode:!1,position:"absolute",gridpadding:"10px",leftHeader:"",Cancel:F.Edit_Var_Cancel,rightHeader:F.DictionaryHeader,isRightFooter:!1,isLeftFooter:!1,headerControl:null,headerText:"",parent:this.options.parent};this.sliderView=new r(e).render()},initialiseHorizontalCollection:function(){this.cfgCollectionHorizontal=new w,this.cfgCollectionHorizontal.setAttachedModels(this.attachedModels),this.cfgCollectionHorizontal.setSelectedInstances(this.options.selectedInstances),this.cfgCollectionHorizontal.setEvolutionExpression(""),this.cfgCollectionHorizontal.initialiseModels(),E.getFilterablesVariantGrid(k.attachedModels[0].physicalId,k.options.selectedInstances).then((async function(e){V.setToolbarState([{IdValue:"ID_SwitchView",StateValue:!1}]);var t=k.cfgCollectionHorizontal.at(0);if(t.set("gridEffectivityForConfigurationContext",e),t.onModelUpdateCallback=k.onModelUpdateCallback,!0===A.getCfgUXEnvVariables().isMassVariant_customAttribute_Enabled){let t=k.cfgCollectionHorizontal.selectedInstances.map((e=>e.referenceId)),i=await M.getExtensions(t);e.extenstionsList=i}t.createColumns(e),t.createTreeDocument(e),t.launchCustomViewManager=k.launchCustomViewManager,console.log(e),k.loadNextModelsEffectivitiesAsyncronously(k.attachedModels,k.options)}))},loadNextModelsEffectivitiesAsyncronously:function(e,t){for(var i=[],o=1;o<e.length;o++)i.push(E.getFilterablesVariantGrid(e[o].physicalId,t.selectedInstances));Promise.all(i).then((function(t){for(var i=0;i<t.length;i++){var o=k.cfgCollectionHorizontal.get(e[i+1].physicalId);o.set("gridEffectivityForConfigurationContext",t[i]),o.onModelUpdateCallback=k.onModelUpdateCallback,o.createColumns(t[i]),o.createTreeDocument(t[i]),k.isModified=!1}}))},resetHorizontalCollection:function(){for(var e=this.cfgCollectionHorizontal.length,t=0;t<e;t++){var i=this.cfgCollectionHorizontal.at(t),o=i.get("gridEffectivityForConfigurationContext");console.log(o),i.createColumns(o),i.createTreeDocument(o)}},initialiseModelSelector:function(){var t={onChangeCB:this.onHeaderControlChangeCB,data:this.attachedModels};if(this.modelSelector=new D(t),!0===this.options.touchMode?this.options.parent.getElement(".CfgModelName").setAttributeNode(document.createAttribute("touch-mode")):!1===this.options.touchMode&&this.options.parent.getElement(".CfgModelName").removeAttribute(document.createAttribute("touch-mode")),this.modelSelector.render(),this.modelSelector.enable(),1==this.isMultipleModelsAttached){var i=e.createElement("div",{});i.setStyle("width","calc(100% - 320px)"),i.inject(this.options.parent.header),this.modelSelector._wuxComboBox.inject(i),this.modelSelector._wuxComboBox.elements.container.setStyle("width","300px"),this.options.parent.getElement(".CfgModelName").setStyle("margin","0px 10px 0px 0px")}else{var o=e.createElement("div",{class:"modelTitle",html:s.escapeSpecialCharacters(this.modelSelector._text)});!0===this.options.touchMode?o.setAttributeNode(document.createAttribute("touch-mode")):!1===this.options.touchMode&&o.removeAttribute(document.createAttribute("touch-mode")),o.inject(this.options.parent.header),this.options.parent.header.setStyle("height","40px")}},onModelUpdateCallback:function(){k.isModified=!0,k.updateDisplayExpression()},updateDisplayExpression:function(){var e="";1==k.checkFlag?e=k.cfgCollectionVertical.getGlobalXMLExpression("TXT"):e=k.cfgCollectionHorizontal.processJsonToXml("TXT")[k.options.selectedInstances[0].instanceId].xml;var t="";""!=e&&(t=s.getDisplayExpressionUsingXSLT(e)),""==t?this.cfgExpressionViewObj.updateExpression(F.No_Eff_Msg):(t=null==t?" ":t,this.cfgExpressionViewObj.updateExpression(t))},getProbesInfoDetailsWithXML:function(e){let t=[];for(let e=0;e<k.cfgCollectionVertical.length;e++){let i=k.cfgCollectionVertical.at(e).id,o=p.getDictionaryByCriteria(i,"features");null!=o&&t.push({currentModelName:o.name,currentModelFeatures:o})}return S.getProbesVariantCriteria(e,t)},getGlobalXMLExpression:function(){return 1==k.checkFlag?k.cfgCollectionVertical.getGlobalXMLExpression():k.cfgCollectionHorizontal.processJsonToXml("XML")[k.options.selectedInstances[0].instanceId].xml},initialiseContainers:function(){this.options.parent.header=this.options.parent.getElement(".CfgVariantheader"),this.options.parent.body=this.options.parent.getElement(".CfgBodyContainer"),this.initialiseExpressionContainer(),this.options.parent.autocompleteContainer=this.options.parent.getElement(".containerAuto"),this.options.parent.toolbarContainer=this.options.parent.getElement(".containerIconbar"),this.options.parent.effectivityGridContainer=this.options.parent.getElement(".containerEffectivityTable"),this.options.parent.containerHeaderBar=this.options.parent.getElement(".containerHeaderBar"),k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled&&(this.options.parent.body.addClassName("CfgWuxBodyContainer"),!0===this.options.touchMode?this.options.parent.containerHeaderBar.setAttributeNode(document.createAttribute("touch-mode")):!1===this.options.touchMode&&this.options.parent.containerHeaderBar.removeAttribute(document.createAttribute("touch-mode")),this.options.parent.containerHeaderBar.addClassName("cfgWuxAutocomplete"))},initialiseExpressionContainer:function(){e.createElement("div",{styles:{height:"100%"},html:this.options.parent.body.children[0]}).inject(this.options.parent.body);var t={effArea:"",effExpHeaderTitle:F.Eff_Expression,viewContainer:this.options.parent.body,defaultExpressionContainerHeight:70,displayCompactMode:!this.options.touchMode,inputData:"",minimizeTooltip:F.Min_EBox,maximizeTooltip:F.Max_EBox};this.cfgExpressionViewObj=new I(t),this.cfgExpressionViewObj.render()},initialiseVerticalCollection:function(){this.cfgCollectionVertical=new y,this.cfgCollectionVertical.initialiseCollectionOptions(k.options),this.cfgCollectionVertical.initialiseModels(this.onModelUpdateCallback)},resetAttributes:function(){for(var e=0;e<k.cfgCollectionVertical.length;e++){var t=k.cfgCollectionVertical.at(e),i=p.getDictionaryByCriteria(t.get("idModel"),"features");k.initialiseFeatureTypeForEffectivityOptions(t,i)}},onHeaderControlChangeCB:function(e){k.probesData.push("Edit_Variant_Effectivity_Single_Context_Change"),k.initialiseUI(k.cfgCollectionVertical.get(e.physicalId));var t=k.getCurrentSelectedView();k.cssAdjustmentsForLayout(t,k.attachedModels.length),k.updateDisplayExpression()},initialiseUI:function(e){this.currentSelectedModelId=e.get("id"),this.options.onSelectCallback=this.addFeatureOptionsinTreeDocument,this.initialiseAutocompleteView(this.options),this.buildUI(e),this.initialiseDictionary(e)},buildUI:function(e){let t=[{IdValue:"ID_Dictionary",StateValue:!1}];1==k.checkFlag?(k.initialiseVerticalEffectivityView(e),k.initialiseToolbar(k.effectivityGridView.toolbar),V.setToolbarState(t),"Native"!=window.enoviaServerFilterWidget.mode?k.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!0}):k.effectivityGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!1}),k.effectivityGridView.toolbar.updateNodeModel("ID_ColumnManager",{visibleFlag:!0}),k.effectivityGridView.toolbar.updateNodeModel("ID_SEARCHFEATUREOPTION",{visibleFlag:!0})):(k.initialiseHorizontalEffectivityView(e.get("idModel")),k.initialiseToolbar(k.horizontalGridView.toolbar));let i=k.getCurrentSelectedView();k.cssAdjustmentsForLayout(i,k.attachedModels.length),k.updateDisplayExpression(),k.isModified=!1},addFeatureOptionsinTreeDocumentFromTreeView:function(e,t){if(!0===k.isWebUXAutocompleteEnabled){var i=k.autocomplete.myAutoComplete._model.getAllDescendants(),o={};if(e.self.options){for(var a=0;a<i.length;a++)if(e.self.name==i[a].options.value){o=i[a].options;break}}else{var n={};for(a=0;a<i.length;a++)e.feature.name==i[a].options.value&&(n=i[a].options),e.self.name==i[a].options.value&&(o=i[a].options);o._parentNode=n}o.originalData=e}else{i=k.autocomplete.autocompleteHierarchicalInput.datasets[0].items,o={};if(e.self.options){for(a=0;a<i.length;a++)if(e.self.name==i[a].value){o=i[a];break}}else{for(n={},a=0;a<i.length;a++)e.feature.name==i[a].value&&(n=i[a]),e.self.name==i[a].value&&(o=i[a]);o.parentReference=n}o.originalData=e}0==t?k.addFeatureOptionsinTreeDocument(o):k.removeFeatureOptionsinTreeDocument(o)},removeFeatureOptionsinTreeDocument:function(e){var t=(a=k.cfgCollectionVertical.get(k.currentSelectedModelId)).get("treeDocument");t.prepareUpdate(),t.unselectAll();for(var i=t.getAllDescendants(),o=0;o<i.length;o++)i[o]._options.data.value==e.value&&i[o].select();if(t.pushUpdate(),a.removeRows(),k.disableDictionaryItems(a),0==k.checkFlag){k.horizontalGridView.toolbar.isCopyOperationPerformed="NO",k.horizontalGridView.toolbar.currentModel.set("copiedInstances",[]),k.horizontalGridView.options.treeDocument.unselectAll();var a=k.cfgCollectionHorizontal.get(k.currentSelectedModelId),n=k.getSelectedObjectFromDictionaryView(e);a.removeEffectivityGridViewColumn(n),k.horizontalGridView.refreshColumns(a.get("gridViewEffectivityColumns"),!0,a.modifiedFeatureIds,a.modifiedOptionIds),k.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),k.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)}k.onModelUpdateCallback(),k.probesData.push("Edit_Variant_Effectivity_Single_Remove_Feature_Options")},addFeatureOptionsinTreeDocument:function(e){(t=k.cfgCollectionVertical.get(k.currentSelectedModelId)).get("columns");if(k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?t.addRowWebUX(e):t.addRow(e),k.disableDictionaryItems(t),localStorage.getItem("wux-collectionView-dataGridView")){let e=JSON.parse(localStorage.getItem("wux-collectionView-dataGridView"))[k.effectivityGridView.custom_view_options.dgvHandle.identifier];e&&e.customViews&&(e.currentCustomViewIdentifier=e.currentCustomViewId,k.restoreCustomAttributesEffectivityView(e))}if(0==k.checkFlag){k.horizontalGridView.toolbar.isCopyOperationPerformed="NO",k.horizontalGridView.toolbar.currentModel.set("copiedInstances",[]),k.horizontalGridView.options.treeDocument.unselectAll();var t=k.cfgCollectionHorizontal.get(k.currentSelectedModelId),i=k.getSelectedObjectFromDictionaryView(e);k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?t.addEffectivityGridViewColumnWUX(i):t.addEffectivityGridViewColumn(i),k.horizontalGridView.refreshColumns(t.get("gridViewEffectivityColumns"),!1,t.modifiedFeatureIds,t.modifiedOptionIds),k.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),k.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)}k.onModelUpdateCallback(),k.probesData.push("Edit_Variant_Effectivity_Single_Add_Feature_Options")},getSelectedObjectFromDictionaryView:function(e){for(var t=k.cfgCollectionVertical.get(k.currentSelectedModelId).get("treeDocumentVariantDictionary").getAllDescendants(),i=0;i<t.length;i++){var o=t[i];if(o._options.data.self.name==e.value)return o._options.data;if(k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled&&void 0===e.value&&o._options.data.self.name==e._options.value)return o._options.data}return null},disableDictionaryItems:function(e){if(k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled){var t=e.getSelectedFeatureOptions(),i=e.getDeletedFeatureOptions();k.autocomplete.enableAutocompleteItems(t,i)}else{t=e.getSelectedFeatureOptions();k.autocomplete.setDisable(t)}null!=k.featureOptionsView&&k.featureOptionsView.setChecked(t)},initialiseVerticalEffectivityView:async function(e){this.options.parent.effectivityGridContainer.setHTML("");var t={};t.columns=e.get("columns"),t.columns[0].selectableFlag=!1,t.treeDocument=e.get("treeDocument"),t.onToolbarClickCallback=k.onToolbarClickCallback,t.touchMode=this.options.touchMode,this.effectivityGridView=new d(t),this.effectivityGridView.render().VariantGridView.inject(this.options.parent.effectivityGridContainer);let i={dgvDiv:this.sliderView._leftPanel.getElement(".gridViewContainer"),ootb_columns:[...this.effectivityGridView.columnsDeepCloned],dgvHandle:this.effectivityGridView.VariantGridView,settings:{url:enoviaServerFilterWidget.baseURL,securityContext:enoviaServerFilterWidget.mySecurityContext,refRequired:!1,isNative:enoviaServerFilterWidget.isNative,iterateRootNodesOnly:!1,tenant:enoviaServerFilterWidget.tenant}};if(this.effectivityGridView.custom_view_options=i,M.registerCustomEventsOnDGV(this.effectivityGridView.custom_view_options),localStorage.getItem("wux-collectionView-dataGridView")){let e=JSON.parse(localStorage.getItem("wux-collectionView-dataGridView"))[this.effectivityGridView.custom_view_options.dgvHandle.identifier];e&&e.customViews&&(e.currentCustomViewIdentifier=e.currentCustomViewId,this.restoreCustomAttributesEffectivityView(e))}this.effectivityGridView.VariantGridView.getCustomViewsManager().onCustomViewsSave=(e,t)=>{N.applyCustomAttributes(e,t,this.effectivityGridView.custom_view_options),this.processEffectivityViewColumns()}},restoreCustomAttributesEffectivityView:function(e){N.restoreCustomViews(e,this.effectivityGridView.custom_view_options).then((e=>{this.processEffectivityViewColumns()}))},processEffectivityViewColumns:function(){let e=k.effectivityGridView.custom_view_options.dgvHandle.columns;for(i=e.length-1;i>=0;i--)"tristate"!==e[i].typeRepresentation&&(e[i].selectableFlag=!1,e[i].children&&(0===e[i].children.length?k.effectivityGridView.VariantGridView.removeColumnOrGroup(e[i]):e[i].children.map((e=>{e.selectableFlag=!1}))));k.effectivityGridView.custom_view_options.dgvHandle.columns.filter((e=>"tristate"===e.typeRepresentation)).forEach((e=>{k.effectivityGridView.VariantGridView.removeColumnOrGroup(e),k.effectivityGridView.VariantGridView.addColumnOrGroup(e)}))},initialiseHorizontalEffectivityView:function(e){var t=null,i={treeDocument:(t=void 0===e?this.cfgCollectionHorizontal.at(0):this.cfgCollectionHorizontal.get(e)).get("treeDocumentEffectivityGridView"),columns:t.get("gridViewEffectivityColumns"),context:t.get("configurationContext")};i.columns[0].minWidth=0,i.columns[0].resizableFlag=!1,i.columns[0].alwaysVisibleFlag=!1,this.horizontalGridView=new b(i),this.horizontalGridView.isExpressionColumnAvailable=!1,this.horizontalGridView.render();let o={dgvDiv:this.sliderView._leftPanel.getElement(".gridViewContainer"),ootb_columns:[...this.horizontalGridView.columnsDeepCloned],dgvHandle:this.horizontalGridView.massVariantGridView,settings:{url:enoviaServerFilterWidget.baseURL,securityContext:enoviaServerFilterWidget.mySecurityContext,refRequired:!0,isNative:enoviaServerFilterWidget.isNative,iterateRootNodesOnly:!1,tenant:enoviaServerFilterWidget.tenant}};if(this.horizontalGridView.custom_view_options=o,M.registerCustomEventsOnDGV(this.horizontalGridView.custom_view_options),localStorage.getItem("wux-collectionView-dataGridView")){let e=JSON.parse(localStorage.getItem("wux-collectionView-dataGridView"))[this.horizontalGridView.custom_view_options.dgvHandle.identifier];e&&e.customViews&&(e.currentCustomViewIdentifier=e.currentCustomViewId,N.restoreCustomViews(e,this.horizontalGridView.custom_view_options).then((()=>{let e=this.horizontalGridView.massVariantGridView.treeDocument.getAllDescendants().map((e=>e.options.grid)).map((e=>e.referenceId));M.getValuesForReferenceAttributes(this.horizontalGridView.custom_view_options,e)})))}this.horizontalGridView.massVariantGridView.getCustomViewsManager().onCustomViewsSave=async(e,t)=>{await N.applyCustomAttributes(e,t,this.horizontalGridView.custom_view_options);let i=this.horizontalGridView.massVariantGridView.treeDocument.getAllDescendants().map((e=>e.options.grid)).map((e=>e.referenceId));M.getValuesForReferenceAttributes(this.horizontalGridView.custom_view_options,i)},null!=this.horizontalGridView.toolbar&&(this.horizontalGridView.toolbar.currentModel=t,this.addDictionaryCallbackToHorizontalToolbar()),this.options.parent.effectivityGridContainer.setHTML(""),this.horizontalGridView.massVariantGridView.inject(this.options.parent.effectivityGridContainer),this.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("Expression",!1),this.horizontalGridView.massVariantGridView.layout.setColumnVisibleFlag("instance",!1),this.horizontalGridView.massVariantGridView.layout.setColumnWidth("instance",0)},launchCustomViewManager:function(){N.launchCustomViewManager(k.horizontalGridView.custom_view_options)},addDictionaryCallbackToHorizontalToolbar:function(){"Native"!=window.enoviaServerFilterWidget.mode?this.horizontalGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!0}):this.horizontalGridView.toolbar.updateNodeModel("ID_SwitchView",{visibleFlag:!1}),this.horizontalGridView.toolbar.updateNodeModel("ID_Dictionary",{visibleFlag:!0}),this.horizontalGridView.toolbarExportExtentionsForCallbacks.onShowDictionaryClick=function(e){e._event="ID_DICTIONARY",k.onToolbarClickCallback(e)},this.horizontalGridView.toolbarExportExtentionsForCallbacks.onSwitchViewClick=function(e){e._event="ID_VERTICALVIEW",k.onToolbarClickCallback(e)}},initialiseToolbar:function(e){this.options.parent.toolbarContainer.setHTML(""),e.inject(this.options.parent.toolbarContainer)},onToolbarClickCallback:function(e){if("ID_DELETE"==e._event){k.probesData.push("Edit_Variant_Effectivity_Single_Delete_Operation"),(t=k.cfgCollectionVertical.get(k.currentSelectedModelId)).removeRows(),0==t.get("treeDocument").getAllDescendants().length&&t.clearColumns(),k.disableDictionaryItems(t);let e=k.effectivityGridView.VariantGridView.layout.getLeafColumns(),i=k.effectivityGridView.selectedColumnsIndexes.map((t=>e[t].dataIndex));t.deleteColumns(k.effectivityGridView.selectedColumnsIndexes,e),k.effectivityGridView.VariantGridView._columnsXSO.empty(),k.effectivityGridView.refreshColumns(t.get("columns"),i,!0),k.onModelUpdateCallback()}"ID_CLEAR"==e._event&&((t=k.cfgCollectionVertical.get(k.currentSelectedModelId)).clearRows(),k.disableDictionaryItems(t),k.onModelUpdateCallback());if("ID_COPY"==e._event){k.probesData.push("Edit_Variant_Effectivity_Single_Copy_Operation");var t=k.cfgCollectionVertical.get(k.currentSelectedModelId);let e=k.effectivityGridView.VariantGridView.layout.getLeafColumns(),i=t.copyColumns(k.effectivityGridView.selectedColumnsIndexes,e);k.effectivityGridView.refreshColumns(t.get("columns"),i),k.onModelUpdateCallback()}if("ID_PLUS"==e._event){k.probesData.push("Edit_Variant_Effectivity_Single_Add_New_Combination_Operation");t=k.cfgCollectionVertical.get(k.currentSelectedModelId);k.addColumn(t),k.onModelUpdateCallback()}"ID_DICTIONARY"==e._event&&(k.probesData.push("Edit_Variant_Effectivity_Single_Dictionary_View_Click"),k.sliderView._expandCollapseDockedPanel(e)),"ID_HORIZONTALVIEW"==e._event&&(k.probesData.push("Edit_Variant_Effectivity_Single_Switch_To_MassEdit_View_Click"),1==k.isModified?R("ID_HORIZONTALVIEW"):k.switchViews("ID_HORIZONTALVIEW")),"ID_VERTICALVIEW"==e._event&&(k.probesData.push("Edit_Variant_Effectivity_Single_Switch_To_SingleEdit_View_Click"),1==k.isModified?R("ID_VERTICALVIEW"):k.switchViews("ID_VERTICALVIEW")),"ID_USERSETTINGS"==e._event&&("dictionaryView"===e.viewId?N.launchCustomViewManager(k.featureOptionsView.custom_view_options):"effectivityView"===e.viewId&&N.launchCustomViewManager(k.effectivityGridView.custom_view_options))},buildfeatureOptionView:async function(e,t){var i={touchMode:this.options.touchMode,treeDocument:e,onFeatureOptionSelectionChange:k.addFeatureOptionsinTreeDocumentFromTreeView,features:t,onToolbarClickCallback:k.onToolbarClickCallback};k.featureOptionsView=new f(i),await k.featureOptionsView.render();let o={dgvDiv:this.sliderView._rightPanel.getElement(".gridViewContainer"),ootb_columns:[...this.featureOptionsView.featureOptionGridView.columns],dgvHandle:this.featureOptionsView.featureOptionGridView,settings:{url:enoviaServerFilterWidget.baseURL,securityContext:enoviaServerFilterWidget.mySecurityContext,refRequired:!1,isNative:enoviaServerFilterWidget.isNative,iterateRootNodesOnly:!1,tenant:enoviaServerFilterWidget.tenant}};if(this.featureOptionsView.custom_view_options=o,M.registerCustomEventsOnDGV(this.featureOptionsView.custom_view_options),localStorage.getItem("wux-collectionView-dataGridView")){let e=JSON.parse(localStorage.getItem("wux-collectionView-dataGridView"))[this.featureOptionsView.custom_view_options.dgvHandle.identifier];e&&e.customViews&&(e.currentCustomViewIdentifier=e.currentCustomViewId,N.restoreCustomViews(e,this.featureOptionsView.custom_view_options))}this.featureOptionsView.featureOptionGridView.getCustomViewsManager().onCustomViewsSave=(e,t)=>{N.applyCustomAttributes(e,t,this.featureOptionsView.custom_view_options)},k.featureOptionsView.setColumnRemoveWarningToShow(!1),k.sliderView.clearRightLayout(),k.sliderView.setRightView(k.featureOptionsView.featureOptionGridView,k.featureOptionsView.toolbar),k.featureOptionsView.cssAdjustmentsForLayout(this.options.touchMode,!0)},createDictionaryTreeDocument:function(e){var t=new C,i=new v({dataModelSet:t});i.prepareUpdate();for(var o=0;o<e.length;o++){for(var a=e[o],n={},r=T.getColumnIndexes("VariantsAndOptionGroups"),s=0;s<r.length;s++)n[r[s]]="";var l=new m({label:a.displayName,grid:{name:a.name,type:a.type,checkbx:!1,id:a.physicalID,typeNLS:a.type},data:{self:a,feature:a}});this.updateAttributes(l,a),i.addRoot(l);for(var d=0;d<a.options.length;d++){var c=a.options[d],u=new m({label:c.displayName,grid:{name:c.name,type:c.type,checkbx:!1,id:c.physicalID,typeNLS:c.type},data:{self:c,feature:a}});this.updateAttributes(u,c),l.addChild(u)}}return i.expandAll(),i.pushUpdate(),i},processFilterablesVariantGrid:function(e){var t=[];if(null!=e.features.criterias)for(var i=0;i<e.features.criterias.features.length;i++){var o=e.features.criterias.features[i],a="",n="",r="",s="",l="",d="";o.featureAttributes.results[0].basicData.forEach((function(e){"name"==e.name&&(a=e.value[0]),"type"==e.name&&(r=e.value[0]),"current"==e.name&&(s=e.value[0]),"originated"==e.name&&(l=e.value[0]),"description"==e.name&&null!=e.value&&(d=e.value[0])})),o.featureAttributes.results[0].data.forEach((function(e){"Display Name"==e.name&&(n=e.value[0])}));for(var c={name:a,displayName:n,revision:"-",options:[],type:r,current:s,originated:l,description:d,selectionType:o.featureType,check:!1,physicalID:o.featurePID,typeName:o.featureAttributes.results[0].type},u=0;u<o.options.length;u++){var p=o.options[u],f="",h="",g="",v="",m="",C="";p.optionAttributes.results[0].basicData.forEach((function(e){"name"==e.name&&(f=e.value[0]),"type"==e.name&&(g=e.value[0]),"current"==e.name&&(v=e.value[0]),"originated"==e.name&&(m=e.value[0]),"description"==e.name&&null!=e.value&&(C=e.value[0])})),p.optionAttributes.results[0].data.forEach((function(e){"Display Name"==e.name&&(h=e.value[0])})),c.options.push({name:f,displayName:h,type:g,current:v,originated:m,description:C,selectionType:o.featureType,check:!1,physicalID:p.optionPID,typeName:p.optionAttributes.results[0].type})}t.push(c)}return t},processDictionary:function(e){for(var t=[],i=0;i<e.features.length;i++){var o=e.features[i],a={name:o.name,displayName:o.displayValue,revision:o.revision,options:[],type:o.type_NLS,typeName:o.type,current:o.current_NLS,originated:o.originated,description:null!=o.description?o.description:"",selectionType:o.featureType,check:!1,physicalID:("xRevision"===this.options.isEvolutionBasedOn||this.cfgUseGetAvailableFeaturesOptions)&&o.physicalid?o.physicalid:o.id.replace("pid:","")};if("Preliminary"!==o.current&&"Obsolete"!==o.current){for(var n=0;n<o.options.length;n++){var r=o.options[n];a.options.push({name:r.name,displayName:r.displayValue,type:r.type_NLS,typeName:r.type,current:r.current_NLS,originated:r.originated,description:null!=r.description?r.description:"",selectionType:o.featureType,check:!1,physicalID:("xRevision"===this.options.isEvolutionBasedOn||this.cfgUseGetAvailableFeaturesOptions)&&r.physicalid?r.physicalid:r.id.replace("pid:","")})}t.push(a)}}return t},initialiseDictionary:function(e){this.getDictionary(e)},getDictionary:async function(t){var i=p.getDictionaryByCriteria(t.get("idModel"),"features");if(k.sliderView.clearRightLayout(),k.sliderView.disableRightLayout(),null==i.features){var o=this,a="",n=t.get("evoExp");""!==n&&(a={evolutionExpression:JSON.stringify({filterExpression:S.getValidXmlWithoutDescId(n)})});var r=!1;if("EXTERNAL"==enoviaServerFilterWidget.mode?void 0!==this.options.configurable&&void 0!==this.options.configurable.contextType&&"MODEL_VERSION"==this.options.configurable.contextType&&(r=!0):o.options.onlyModelVersion&&(r=!0),"xRevision"===o.options.isEvolutionBasedOn||o.cfgUseGetAvailableFeaturesOptions){let i;o.options&&o.options.contextData&&(i=o.options.contextData.map((e=>e.physicalID)));let a={version:"1.0",referencePID:t.collection.options.parentID,modelPIDs:[t.id]};if("Native"==window.enoviaServerFilterWidget.mode){if(!o.options.ChangeAuthoringContext&&!o.options.workUnderCompiledForm){let e={instancePID:t.collection.options.instanceID,effectivityCompiledForm:t.collection.options.effectivityCompiledForm?t.collection.options.effectivityCompiledForm:"No Effectivity"};a.instances=[e]}if(o.options&&o.options.ChangeAuthoringContext){let e={operationheader:{key:"DS-Change-Authoring-Context",value:o.options.ChangeAuthoringContext}};a.wsHeaderOptions=e}o.options&&o.options.workUnderCompiledForm&&(a.workUnderCompiledForm=o.options.workUnderCompiledForm)}else{if(!o.options.cfg_auth_ctx){let e={instancePID:t.collection.options.instanceID,effectivityCompiledForm:t.collection.options.evoEffXML||t.collection.options.hasEffectivity?"":"No Effectivity"};a.instances=[e]}if(o.options&&o.options.cfg_auth_ctx&&o.options.cfg_auth_ctx.AuthoringContextHeader){let e=Object.keys(o.options.cfg_auth_ctx.AuthoringContextHeader)[0],t={operationheader:{key:e,value:o.options.cfg_auth_ctx.AuthoringContextHeader[e]}};a.wsHeaderOptions=t}}try{let i=await s.getAvailableFeaturesAndOptions(a);var l=[];if(i&&i.result&&i.result.length>0){for(var d=0;d<i.result[0].features.length;d++){var c=i.result[0].features[d];"Preliminary"!==c.current&&"Obsolete"!==c.current&&l.push(c)}i.features=l,p.addDictionaryByCriteria(t.get("idModel"),i,"features"),o.modelSelector&&o.modelSelector._wuxComboBox&&o.modelSelector._wuxComboBox.currentValue&&o.modelSelector._wuxComboBox.currentValue.physicalId===i.result[0].modelPID&&k.processVariantOptionsData(i,t)}else{s.showNotifs("warning","",F.No_Conf_Features_Title),k.sliderView._rightSpinner.hide();let t=e.createElement("div",{class:"featureOptionsMsg",html:F.No_Variants_Available});k.sliderView.setRightView(t)}}catch{s.showNotifs("error","",F.Dictionary_Error)}}else s.getLegacyCfgDico(t.get("idModel"),a,r).then((function(e){for(var i=[],a=0;a<e.features.length;a++){var n=e.features[a];"Preliminary"!==n.current&&"Obsolete"!==n.current&&i.push(n)}if(e.features=i,p.addDictionaryByCriteria(t.get("idModel"),e,"features"),o.modelSelector&&o.modelSelector._wuxComboBox&&o.modelSelector._wuxComboBox.currentValue&&o.modelSelector._wuxComboBox.currentValue.physicalId===e.id.substr(4,e.id.length)){var r=k.processDictionary(e);k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?k.autocomplete.drawDictionary(r,o.options):k.autocomplete.drawDictionary(r);var s=k.createDictionaryTreeDocument(r);t.set("treeDocumentVariantDictionary",s),k.buildfeatureOptionView(s,e),k.disableDictionaryItems(t),k.initialiseFeatureTypeForEffectivityOptions(t,e);var l=k.cfgCollectionVertical.get(k.currentSelectedModelId);k.effectivityGridView.refreshColumns(l.get("columns")),k.isModified=!1}}),(function(e){s.showwarning(F.Dictionary_Error,"error"),O.unmask(o.options.parent.body)}))}else{o=this;var u=k.processDictionary(i);if(k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?k.autocomplete.drawDictionary(u,o.options):k.autocomplete.drawDictionary(u),void 0===(f=t.get("treeDocumentVariantDictionary"))){var f=k.createDictionaryTreeDocument(u);t.set("treeDocumentVariantDictionary",f)}f=t.get("treeDocumentVariantDictionary"),k.buildfeatureOptionView(f,u),k.disableDictionaryItems(t),V.setToolbarState([{IdValue:"ID_SwitchView",StateValue:!1}])}},processVariantOptionsData:function(e,t){let i=this;var o=k.processDictionary(e);k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?k.autocomplete.drawDictionary(o,i.options):k.autocomplete.drawDictionary(o);var a=k.createDictionaryTreeDocument(o);t.set("treeDocumentVariantDictionary",a),k.buildfeatureOptionView(a,e),k.disableDictionaryItems(t),k.initialiseFeatureTypeForEffectivityOptions(t,e);var n=k.cfgCollectionVertical.get(k.currentSelectedModelId);k.effectivityGridView.refreshColumns(n.get("columns")),k.isModified=!1},isValidEffectivityForDictionary:function(e,t){let i=!0;if(e){let o=[];if(e.length>0){for(let e=0;e<t.features.length;e++)o.push(t.features[e].name);for(let t=0;t<e.length;t++){let a=e[t]._options.data.value;if(-1==o.indexOf(a)){i=!1;break}}}}return i},initialiseFeatureTypeForEffectivityOptions:function(e,t){var i=e.get("treeDocument"),o=t;i.prepareUpdate();var a=i.getRoots();if(1==this.isValidEffectivityForDictionary(a,o)){for(var n=0;n<a.length;n++)for(var r=a[n]._options.data.value,l=0;l<o.features.length;l++)if(r==o.features[l].name){this.updateAttributes(a[n],o.features[l]),a[n]._options.data.featureType=o.features[l].featureType,a[n]._options.data.self={},a[n]._options.data.self.physicalID="xRevision"===this.options.isEvolutionBasedOn&&o.features[l].physicalid?o.features[l].physicalid:o.features[l].id.slice(4);for(var d=a[n].getChildren(),c=0;c<d.length;c++){d[c]._options.data.featureType=o.features[l].featureType;for(var u=o.features[l].options,p=0;p<u.length;p++)d[c]._options.data.value==u[p].name&&(d[c]._options.data.self={},d[c]._options.data.self.physicalID="xRevision"===this.options.isEvolutionBasedOn&&u[p].physicalid?u[p].physicalid:u[p].id.slice(4),this.updateAttributes(d[c],u[p]),p=u.length)}}}else s.showwarning(F.Evolution_Impact_Msg,"warning");if(i.pushUpdate(),localStorage.getItem("wux-collectionView-dataGridView")){let e=JSON.parse(localStorage.getItem("wux-collectionView-dataGridView"))[this.effectivityGridView.custom_view_options.dgvHandle.identifier];e&&e.customViews&&(e.currentCustomViewIdentifier=e.currentCustomViewId,this.restoreCustomAttributesEffectivityView(e))}},updateAttributes:function(e,t){var i=e._options.grid;i.id=t.physicalID?t.physicalID:t.physicalid?t.physicalid:t.id.slice(4);for(var o=T.getColumnIndexes("VariantsAndOptionGroups"),a=0;a<o.length;a++){var n=o[a];"type"!=o[a]&&"current"!=o[a]||(n+="_NLS"),null==t[n]&&(n=o[a]),null==t[n]&&(t[n]=""),i[o[a]]=t[n]}let r=t.typeName||t.type;"VariabilityGroup"===r?i.type="Variability Group":"VariabilityOption"===r?i.type="Variability Option":"VariantValue"===r?i.type="Variant Value":r&&(i.type=r),i.typeNLS=t.type_NLS||t.type,e.updateOptions({grid:i})},addColumn:function(e){let t=e.addColumn();k.effectivityGridView.refreshColumns(e.get("columns"),t)},getCurrentSelectedView:function(){return 1==k.checkFlag?k.effectivityGridView.VariantGridView:k.horizontalGridView.massVariantGridView},cssAdjustmentsForLayout:function(e,t){1==t?e.getContent(".wux-layouts-collectionview").setStyles({height:"calc(100% - 10px)",top:"10px",bottom:"160px",left:"0px",width:"calc(100% - 0px) ",border:"1px solid rgb(212, 212, 212)"}):e.getContent(".wux-layouts-collectionview").setStyles({height:"calc(100% - 10px)",top:"10px",bottom:"150px",left:"0px",width:"calc(100% - 0px)",border:"1px solid rgb(212, 212, 212)"})},cssAdjustmentsForHeightMinimise:function(e,t){"fullScreenSingle"==t?e.getContent(".wux-layouts-collectionview").setStyles({bottom:"40px"}):"partialScreenSingle"==t&&e.getContent(".wux-layouts-collectionview").setStyles({bottom:"160px"}),"fullScreenMultiple"==t?e.getContent(".wux-layouts-collectionview").setStyles({bottom:"40px"}):"partialScreenMultiple"==t&&e.getContent(".wux-layouts-collectionview").setStyles({bottom:"150px"})},initialiseAutocompleteView:function(e){k.isWebUXAutocompleteEnabled&&!0===k.isWebUXAutocompleteEnabled?k.autocomplete=u.initialiseAutocomplete(e):k.autocomplete=c.initialiseAutocomplete(e)},processAttachedModels:function(e){for(var t=[],i=e,o=0;o<i.length;o++){var a={displayName:"",name:"",revision:""};a.physicalId=i[o].physicalID;for(var n=0;n<i[o].data.length;n++)"Marketing Name"==i[o].data[n].name&&(a.displayName=i[o].data[n].value&&i[o].data[n].value[0]?i[o].data[n].value[0]:"");for(n=0;n<i[o].basicData.length;n++)"name"==i[o].basicData[n].name&&(a.name=i[o].basicData[n].value[0]),"ds6wg:revision"==i[o].basicData[n].name&&(a.revision=i[o].basicData[n].value[0]);""==a.displayName&&(a.displayName=a.name),t.push(a)}return t},initialiseExpandCollpaseEvents:function(){},getModelswithEffExpression:function(){return k.cfgCollectionVertical.getModelswithEffExpression()},switchViews:function(e){k.checkFlag="ID_HORIZONTALVIEW"!=e,k.initialiseVerticalCollection(),k.resetAttributes(),k.resetHorizontalCollection(),k.initialiseUI(k.cfgCollectionVertical.get(k.currentSelectedModelId));var t=k.getCurrentSelectedView();k.cssAdjustmentsForLayout(t,k.attachedModels.length),k.updateDisplayExpression(),k.isModified=!1}};function R(e){var t=function(){o.closeDialog()},i={width:539,height:170,isResizable:!1,dialogue:{header:F.SwitchingView,buttonArray:[{label:"Ok",labelValue:F.Ok,handler:function(){k.isModified=!1,k.switchViews(e),o.closeDialog()},className:"primary"},{label:"Cancel",labelValue:F.Cancel,handler:t,className:"default"}],target:widget.body,object:null,postCrossHandler:t}},o=new _(i);o.render(),o.container.setStyle("overflow","auto"),o.container.setHTML(F.EffectivityReset+"<br><br>"+F.ResetQuestion+"<br>")}return k})),define("DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityInit",["DS/CfgBaseUX/scripts/CfgData","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgVariantEffectivityEditor/scripts/CfgVariantEffectivityController","DS/CfgBaseUX/scripts/CfgContainerView","DS/Utilities/TouchUtils","DS/CfgTracker/CfgTracker","DS/CfgTracker/CfgDimension","DS/CfgTracker/CfgValue","DS/CfgBaseUX/scripts/CfgUXEnvVariables","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","i18n!DS/CfgVariantEffectivityEditor/assets/nls/CfgVariantEffectivityEditor","css!DS/CfgVariantEffectivityEditor/assets/styles/CfgVariantEffectivityEditor.css"],(function(e,t,i,o,a,n,r,s,l,d,c,u){"use strict";var p={cancelDialog:function(){p.callCommandClickTrackerEvent({mode:p.varOptions.mode,operation:"Cancel"}),p.cfgVarDialog.closeDialog(),console.log("cfgVarDialog closed")},sendEditVariantTrackerEvent:function(e){let t="",i="",o=e.noOfContext,a=e.noOfReference,n=e.totalVariantLength,d=e.totalVariantValueLength,c=e.totalOptionGroupLength,u=e.totalOptionLength,p=e.totalNotOperatorLength,f=e.variantComplexity,h=e.totalFeaturesLength,g=e.totalFeatureOptionsLength;"Native"==e.mode?(t="Native",i="Web In Win"):(t=widget.data.appId,i=null!=widget.options?widget.options.title:"ODT Environment");let v=r.getDeviceUsedForOperation(),m=r.ConfigOperationMode.CREATE;"Edit"==e.variantMode&&(m=r.ConfigOperationMode.EDIT);let C=r.AuthoringMode.EMPTY;"Empty"!=e.authoringMode&&(C=r.AuthoringMode[e.authoringMode]);let V=r.EditVariantMode.SINGLE;r.createEventBuilder({category:r.Category.USAGE,action:r.Events.CLICK,tenant:enoviaServerFilterWidget.tenant}).setLabel(r.Labels.EDIT_VARIANT_EFFECTIVITY).setAppId(t).addDimension(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_WIDGET,i).addDimension(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MEDIA,v).addDimension(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MODE,m).addDimension(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_AUTHORING_MODE,C).addDimension(s.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_TYPE_MODE,V).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_NO_OF_MODEL,o).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_REFERENCE_SELECTED,a).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT,n).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT_VALUE,d).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION_GROUP,c).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION,u).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_NOT_OPERATOR,p).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_COMPLEXITY,f).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURES,h).addPersonalValue(l.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURE_OPTIONS,g).send()},callEditVariantTrackerEvent:function(e){let t={noOfContext:p.MySkeleton.attachedModels.length,mode:"Dashboard"};"Native"==e.mode&&(t.mode="Native"),t.variantMode="Create",1==p.MySkeleton.options.hasEffectivity&&(t.variantMode="Edit"),t.authoringMode="Empty",p.MySkeleton.options.ca.headers.length>0&&("DS-Change-Authoring-Context"==p.MySkeleton.options.ca.headers[0].key?t.authoringMode="CHANGE":"DS-Configuration-Authoring-Context"==p.MySkeleton.options.ca.headers[0].key&&(t.authoringMode="EVOLUTION")),t.noOfReference=1;let i=p.MySkeleton.getProbesInfoDetailsWithXML(e.globalExpression);t.totalVariantLength=i.totalVariantLength,t.totalVariantValueLength=i.totalVariantValueLength,t.totalOptionGroupLength=i.totalOptionGroupLength,t.totalOptionLength=i.totalOptionLength,t.totalNotOperatorLength=i.totalNotOperatorLength,t.variantComplexity=i.variantComplexity,t.totalFeaturesLength=i.totalFeaturesLength,t.totalFeatureOptionsLength=i.totalFeatureOptionsLength,p.sendEditVariantTrackerEvent(t)},callCommandClickTrackerEvent:function(e){let t="Native",o="Rich Client Applications",a="NATIVEWIW";if(widget&&widget.data&&widget.data.appId&&(t=widget.data.appId),widget&&widget.options&&widget.options.title&&(o=widget.options.title),"Dashboard"==e.mode&&(a="DASHBOARD"),"OK"==e.operation)for(let e=0;e<p.MySkeleton.probesData.length;e++){let n={AppId:t,AppName:o,CommandOperation:p.MySkeleton.probesData[e],CommandName:r.Labels.EDIT_VARIANT_EFFECTIVITY,ConfigMode:r.ConfigMode.CONTEXTUAL,ApplicationMode:a};i.sendConfgurationCommandsClickEventForMagicProbes(n)}else{let e={AppId:t,AppName:o,CommandOperation:"Edit_Variant_Single_Cancel",CommandName:r.Labels.EDIT_VARIANT_EFFECTIVITY,ConfigMode:r.ConfigMode.CONTEXTUAL,ApplicationMode:a};i.sendConfgurationCommandsClickEventForMagicProbes(e)}},setVariantEffectivity:function(){null!=p.cfgVarDialog.footerButton.Apply&&(p.cfgVarDialog.footerButton.Apply.disabled=!0);var e=p.MySkeleton.getGlobalXMLExpression();if(console.log("Variant XMLExpression : "+e),1!=p.varOptions.isEmptyVariantEffectivity||""!=e){p.globalExpression=e;var t,o=function(e){console.log(e);var t=" ",o=" ";if(null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var a=e.results[0],n=a.existing,r=a.new;if(null!=n&&null!=n.pid&&(t=n.pid,null!=n.content&&null!=n.content.Variant)){var s=n.content.Variant;e.results[0].existing.content.displayExpression=i.getDisplayExpressionUsingXSLT(s)}if(null!=r&&null!=r.pid&&(o=r.pid,null!=r.content&&null!=r.content.Variant)){var l=r.content.Variant;e.results[0].new.content.displayExpression=i.getDisplayExpressionUsingXSLT(l)}}if(p.varOptions.postOKHandler&&p.varOptions.postOKHandler(e),null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var d={commandName:"cfgEditVariant",widgetId:widget.id,response:i.getEventResponse(e),data:{}};i.publishPostProcessingEventForApplications(d)}if(" "!=t&&" "!=o&&i.showwarning(u.CFG_Application_Refresh_For_Instance_Evolved,"info"),p.cfgVarDialog.closeDialog(),void 0!==e.GlobalStatus&&"SUCCESS"==e.GlobalStatus||void 0!==e.unset&&("SUCCESS"===e.unset.Variant.status.toUpperCase()||"WARNING"===e.unset.Variant.status.toUpperCase()))i.showwarning(u.Save_Successful_Var_Effectivity,"success");else if(void 0!==e.GlobalStatus&&"ERROR"==e.GlobalStatus&&void 0!==e.results[0].errorDetails){if(126==e.results[0].errorCode){let e="";null!=p.cfgVarDialog&&null!=p.cfgVarDialog.options&&null!=p.cfgVarDialog.options.dialogue&&null!=p.cfgVarDialog.options.dialogue.header&&2==p.cfgVarDialog.options.dialogue.header.split("- ").length&&p.cfgVarDialog.options.dialogue.header.split("- ")[1].length>0&&(e=p.cfgVarDialog.options.dialogue.header.split("- ")[1]);let t=c.CfgMessageNoEditVariantTitle.replace("{1}",e),o=c.CfgMessageNoEditVariantAction.replace("{1}","<b>"+c.CfgHeaderEditConfigurationContext+"</b>");i.showNotifs("error",t,c.CfgMessageNoEditVariantSubTitle,o)}else e.results[0].message&&""!=e.results[0].message&&i.showwarning(u.Save_Fail_Var_Effectivity+" "+e.results[0].message,"error");console.log("Edit Variant Effectivity operation error = "+e.results[0].errorDetails)}else i.showwarning(u.Save_Fail_Var_Effectivity,"error");p.callEditVariantTrackerEvent({mode:"Dashboard",globalExpression:p.globalExpression}),p.callCommandClickTrackerEvent({mode:"Dashboard",operation:"OK"})},a=function(e){console.log(e),p.cfgVarDialog.closeDialog(),i.isDefined(e)&&i.isDefined(e.errorMessage)?i.showwarning(u.Save_Fail_Var_Effectivity+"\n"+e.errorMessage,"error"):i.showwarning(u.Save_Fail_Var_Effectivity,"error")},n=null;if(p.varOptions.ca.headers.length>0&&(n={operationheader:{key:p.varOptions.ca.headers[0].key,value:p.varOptions.ca.headers[0].value}}),""==e){var r=[];r.push(p.varOptions.instanceID),t={version:"2.0",wsOptions:n,unsetList:r,domain:"Variant"},i.unsetVariantEffectivities(t).then((function(e){o(e)}),(function(e){a(e)}))}else t={version:"1.1",domain:"Variant",view:"All",expressionList:[{pid:p.varOptions.instanceID,VariantContent:e}],wsOptions:n},"xRevision"===p.varOptions.isEvolutionBasedOn&&(t.version="2.0"),i.setVariantEffectivities(t).then((function(e){o(e)}),(function(e){a(e)}))}else p.cfgVarDialog.closeDialog()},onSaveEffectivity:function(e){var t={eventName:"cfgEditVariantEffectivity",operation:"firstButton"==e.buttonId?"OK":"Cancel",operationVersion:"1.0",content:""};if("Native"==window.enoviaServerFilterWidget.mode){null!=p.variantContainer&&null!=p.variantContainer._firstButton&&(p.variantContainer._firstButton.disabled=!0);var o={modelIdsWithEffectivity:p.MySkeleton.getModelswithEffExpression(),globalEffectivityExpression:p.MySkeleton.getGlobalXMLExpression(),propagateSessionEffectivity:e.propagateSessionEffectivity};t.content=JSON.stringify(o),i.sendNotificationWebInWin(t),p.callEditVariantTrackerEvent({mode:"Native",globalExpression:o.globalEffectivityExpression}),p.callCommandClickTrackerEvent({mode:"Native",operation:t.operation})}else if("EXTERNAL"==window.enoviaServerFilterWidget.mode){var a={version:"0.1",xmlExpression:p.MySkeleton.getGlobalXMLExpression(),configurable:p.varOptions.configurable,filterables:p.varOptions.filterables};if(1==i.isParamDefined(a.xmlExpression))i.setVariantforExternal(a).then((function(e){t.content=JSON.stringify(e),i.sendNotificationWebInWin(t)}));else if(1==i.isDefined(a.filterables))if(0==a.filterables.length){var n={filterables:[]};t.content=JSON.stringify(n),i.sendNotificationWebInWin(t)}else{a={version:"0.1",configurable:p.varOptions.configurable,filterables:p.varOptions.filterables};i.unsetVariantforExternal(a).then((function(e){t.content=JSON.stringify(e),i.sendNotificationWebInWin(t)}))}else{n={filterables:[]};t.content=JSON.stringify(n),i.sendNotificationWebInWin(t)}}},init:function(i){e.clear(),this.varOptions=i,this.varOptions.touchMode=n.getTouchMode();var r=this;if("Dashboard"==this.varOptions.mode)this.varOptions.dialogue.buttonArray=[{label:"Apply",labelValue:u.Edit_Var_OK,handler:r.setVariantEffectivity,className:"primary"},{label:"Cancel",labelValue:u.Edit_Var_Cancel,handler:r.cancelDialog,className:"default"}],this.varOptions.height=1e3,this.varOptions.width=1100,this.varOptions.minHeight=406,this.varOptions.minWidth=320,this.varOptions.touchMode=!!this.varOptions.touchMode,this.cfgVarDialog=new t(this.varOptions),this.cfgVarDialog.render(),this.varOptions.parent=this.cfgVarDialog.container,this.varOptions.parentElement=this.cfgVarDialog.container,this.MySkeleton=o.init(this.varOptions);else{var s={isHeader:!1,isFooter:!0,firstButtonText:u.Edit_Var_OK,secondButtonText:u.Edit_Var_Cancel,headerText:"",toggleSessionEffectivity:!1,onButtonClickCB:r.onSaveEffectivity};this.variantContainer=new a(s).render(),this.variantContainer.inject(i.parentElement),this.varOptions.parent=this.variantContainer._body,this.MySkeleton=o.init(this.varOptions)}}};return p}));