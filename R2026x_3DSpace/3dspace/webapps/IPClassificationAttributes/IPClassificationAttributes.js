define("DS/IPClassificationAttributes/utils/AlertBox",["UWA/Core","DS/UIKIT/Alert","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes"],(function(e,t,a){"use strict";return{createAlertBox:function i(n){if(e.is(n,"string"))return i({message:n,fixed:!1});if(e.is(n,"object"))return i([n]);var r=null;if(e.is(n,"array")){var l=n.map((function(t){let i="";if(e.is(t,"string")&&(i=t),e.is(t,"object")){t.className&&null==r&&(r=t.className),i=t.message||a.get(t.nls)||void 0;for(let[e,a]of Object.entries(t))i=i.replace("%"+e+"%",a);t.values&&(i=i+" <br/> "+t.values.map((e=>"&laquo; "+e+" &raquo;")).join(" - "))}return i}));let i=new t({visible:!0,autoHide:!0,hideDelay:2e3});return i.add({className:r||"error",message:1==l.length?l[0]:"<ol><li>"+l.join("</li><li>")+"</li></ol>"}),i}throw"Unexpected parameter type"}}})),define("DS/IPClassificationAttributes/utils/TableBuilder",["UWA/Class","DS/UIKIT/Input/Text","DS/UIKIT/Input/Select","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Date","DS/UIKIT/Autocomplete","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes"],(function(e,t,a,i,n,r,l){"use strict";return e.singleton({init:function(){this._parent({})},createTextField:function(e,a){var i=new t({id:e.id+a,placeholder:e.placeholder?e.placeholder:"",className:e.className?e.className:"",events:{onChange:function(t){e.onChange&&e.onChange(t,e,a)}}});return e.onInput&&(i.elements.input.oninput=function(t){e.onInput(t,e)}),e.CustomValidate&&(i.CustomValidate=e.CustomValidate),i},createDateField:function(e,t){return new n({id:e.id+t,placeholder:e.placeholder?e.placeholder:"",showClearIcon:!0,events:{onChange:function(t){e.onChange&&e.onChange(t,e)}}})},createToggleField:function(e,t){return new i({id:e.id+t,type:e.type,value:e.value,label:"",checked:!!e.checked&&e.checked,events:{onChange:function(a){e.onChange&&e.onChange(a,e,t)}}})},createAutoCompleteField:function(e,t){let a=new r({showSuggestsOnFocus:!0,multiSelect:!1,minLengthBeforeSearch:0,datasets:[],placeholder:e.placeholder,style:{overflow:"visible"},events:{onSelect:function(a){e.onSelect&&e.onSelect(e,t,a)},onUnselect:function(a){e.onUnselect&&e.onUnselect(e,t,a)},onHideSuggests:function(){e.onHideSuggests&&e.onHideSuggests()}}});return e.datasets&&a.addDataset(e.datasets),a},createSelectField:function(e,t){return new a({id:e.id+t,placeholder:l.SELECT_OPTION_MSG,disabled:!!e.disabled&&e.disabled,options:e.items})},createTable:function(e){var t=UWA.createElement("table",{class:"table",id:"attrTable",styles:{width:"2600px",height:"300px","max-width":"unset",display:"block","table-layout":"fixed"}});e.wrapper&&t.inject(e.wrapper),e.caption&&(t.createCaption().innerHTML=e.caption);var a=UWA.createElement("thead",{class:"attrthead",id:"attrthead"}).inject(t),i=UWA.createElement("tbody",{class:"attrtbody",id:"attrtbody"}).inject(t),n=UWA.createElement("tr").inject(a);e.headersDef.forEach((function(e){if(e.visible){var t=UWA.createElement("th",{colspan:"1",align:"left",width:e.width?e.width:"250px","white-space":"nowrap",overflow:"hidden",id:e.headerId});UWA.createElement("p",{text:e.headerName,class:""}).inject(t),t.inject(n)}}));for(var r=[],l=e.fieldsDef,s=this,o=0;o<3;o++){var u={},d=UWA.createElement("tr").inject(i);l.forEach((function(t){if(t.visible){t.headerDiv=e.alertContainer;var a=new UWA.createElement("td",{colspan:"1",align:"left",width:t.width?t.width:"250px"}).inject(d);switch(t.type){case"text":t.lines=r,u[t.fieldName]=s.createTextField(t,o),u[t.fieldName].inject(a);break;case"date":u[t.fieldName]=s.createDateField(t,o),u[t.fieldName].inject(a);break;case"autocomplete":var i=UWA.createElement("div",{id:t.id+o,class:t.className,styles:{overflow:"visible"}}).inject(a);t.lines=r,u[t.fieldName]=s.createAutoCompleteField(t,o),u[t.fieldName].inject(i);break;case"select":u[t.fieldName]=s.createSelectField(t,o),u[t.fieldName].inject(a);break;case"switch":t.lines=r,u[t.fieldName]=s.createToggleField(t,o),u[t.fieldName].inject(a);break;case"chooser":var n=UWA.createElement("div",{class:"input-group"}).inject(a);t.lines=r,u[t.fieldName]=s.createTextField(t,o),u[t.fieldName].inject(n);var l=UWA.createElement("span",{class:t.classIcon}).inject(n);l.line=u,l.onclick=function(e){t.iconClickAction&&t.iconClickAction(e,t,o)}}}})),r.push(u)}return r}})})),define("DS/IPClassificationAttributes/utils/AttributesUtil",["UWA/Class","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/ClassificationEditor/utils/ClassificationEditorcontrol","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json"],(function(e,t,a,i,n,r){"use strict";return e.singleton({init:function(){this._parent({})},haveDataToExport(){var e=n.getContent().getView().getPADTreeListView().getManager().treeDocument.getRoots();return e&&Array.isArray(e)&&e.length>0},getDataToUpgrade(){var e=n.getContent().getView().getPADTreeListView().getManager().treeDocument.getRoots(),t=[];return e&&Array.isArray(e)&&e.forEach((function(e){var a=e.getAttributeValue("values").isInDico,i=e.getAttributeValue("Name");"true"==a||i.includes(" ")||t.push(i)})),t},checkRange:function(e,t,a,i,n,r){var l,s=(a?a.split(";"):[]).map((e=>e.trim())).filter((e=>e.length>0)),o=(t&&t.split(";").filter((e=>!s.includes(e)&&i&&i.includes(e))),s.filter(((e,t)=>s.indexOf(e)==t))),u=s.filter(((e,t)=>s.indexOf(e)!=t));(a&&r&&!a.includes(r)&&(n.push({fixed:!0,nls:"attrDefaultChangeError",values:[r],className:"info"}),s=o),u.length>0&&(n.push({fixed:!0,nls:"attrRangeErrDupValue",values:u.filter(((e,t)=>u.indexOf(e)==t))}),s=o),"Integer"==e||"integer"==e)&&((l=s.filter((e=>!/^[-+]?[0-9]+$/.test(e)))).length&&n.push({fixed:!1,nls:"attrRangeErrInteger",values:l,type:"warning"}));"Double"!=e&&"double"!=e&&"real"!=e||(l=s.filter((function(e){return!new RegExp("^[-+]?\\d+(\\.\\d+)?$").test(e)}))).length&&n.push({fixed:!1,nls:"attrRangeErrDouble",values:l});"String"!=e&&"string"!=e||(l=s.filter((e=>!/^[a-zA-Z0-9]+$/.test(e)))).length&&n.push({fixed:!1,nls:"attrRangeErrAlphanumeric",values:l});return s=(s=s.map((e=>e.trim()))).filter((e=>e.length>0)),"String"==e&&(s=s.sort()),"Integer"==e&&(s=s.sort(((e,t)=>parseInt("0"+e)-parseInt("0"+t)))),s},extractArributesNode:function(e){var t=JSON.parse(r);return e.Dictionary.Interfaces[t.interface_name].Attributes},formatObjectToSend:function(e){var t=JSON.parse(r);return{AggregatorPackage:t.package_name,AggregatorName:t.interface_name,AggregateMode:"Global",AggregatorNature:"Interface",Attributes:e}},buildObjectToDelete:function(e){if(e&&Array.isArray(e)){var t=JSON.parse(r),a={AggregatorPackage:t.package_name,AggregatorName:t.interface_name,AggregateMode:"Global",AggregatorNature:"Interface",Attributes:{}};e.forEach((function(e){a.Attributes[e]={Name:e,Owner:""}}))}return a},buildObjectToSend:function(e,t,a){var i=JSON.parse(r),n={AggregatorPackage:i.package_name,AggregatorName:i.interface_name,AggregateMode:"Global",AggregatorNature:"Interface",Attributes:{}};return e.every(((e,i)=>{var r=t[i].nameField.getValue();if(console.log("name : "+r),r.length>0){var l=t[i].authorizedField,s=t[i].defaultValue;if(l&&s.validateWhenRangeIsDefined&&!s.validateWhenRangeIsDefined(l))return!1;var o=t[i].defaultValue.getValue(),u="";if("Date"==a){var d=t[i].defaultValue.getDate();if(null!=d||null!=d){let e=new Date(d.toDateString()+" 10:00:00 GMT");o=Math.floor(e.getTime()/1e3).toString(),u=d.toDateString()}}Array.isArray(o)&&o.length>0&&(o=o[0]);var c=[],p={};if("String"==a||"Integer"==a||"Double"==a){var m=l.getValue();if(m&&m.length>0&&(c=m.split(";")),c=(c=c.map((e=>e.trim()))).filter((function(e){return""!=e})),null!=t[i].theRangeModal){var g=new Map(Object.entries(t[i].theRangeModal.getNLSRange()));g&&c.forEach(((e,t)=>{var a=g.get(e);a?(Object.keys(a).forEach(((e,t)=>{0==a[e].length&&delete a[e]})),p[e]=a):p[e]={value:e}}))}}let D=e.getElement("#NLSValueEN"+i);var f={en:0==D.value.length?r:D.value,fr:e.getElement("#NLSValueFR"+i).value,de:e.getElement("#NLSValueDE"+i).value,ja:e.getElement("#NLSValueJA"+i).value,ko:e.getElement("#NLSValueKO"+i).value,ru:e.getElement("#NLSValueRU"+i).value,zh:e.getElement("#NLSValueZH"+i).value};Object.keys(f).forEach(((e,t)=>{0==f[e].length&&delete f[e]}));var h={};h.Name=r,h.Nature="Attribute",h.Description="",h.Type="DoubleWithDim"==a?"Double":a,h.Local="No",h.Owner="",h.Indexation="No",h.Protection="Free",h.NameNLS=f,h.SixWPredicate="",h.SixWPredicate_nls="";var b=t[i].predicateField.selectedItems;if(b&&b.length>0){h.SixWPredicate=b[0].value,h.SixWPredicate_nls=b[0].label.length>0?b[0].label:h.SixWPredicate;var v=t[i].displayIn6WTags.getValue();v[0]&&v[0].length>0&&(h.Indexation=v[0])}if(null!=t[i].multiValueField&&(h.MultiValuated=t[i].multiValueField.isChecked()?"Yes":"No"),null!=t[i].multiLineField&&(h.MultiLine=t[i].multiLineField.isChecked()?"Yes":"No"),h.HasRangeDefined=c.length>0?"Yes":"No",c.length>0&&(h.AuthorizedValues=c,h.AuthorizedValuesNLS=p),"DoubleWithDim"==a){t[i].DisplayAsEntered&&t[i].DisplayAsEntered.isChecked()&&(h.DisplayAsEntered="Yes");var y=t[i].dimValue.selectedItems;y.length>0&&(h.HasMagnitude="Yes",h.Dimension=y[0].value,h.Dimension_nls=y[0].label.length>0?y[0].label:h.Dimension);var A=t[i].preferedUnitValue.selectedItems;A.length>0&&(h.ManipulationUnit=A[0].value,h.ManipulationUnit_nls=A[0].label.length>0?A[0].label:h.ManipulationUnit)}var S=t[i].hasDefaultField;S&&!S.isChecked()||"Yes"===h.MultiValuated?h.HasDefault=!1:(h.HasDefault=!0,h.Default=o,"Date"==a&&(h.Default_display=u)),n.Attributes[r]=h}return!0}))||(n.Attributes={}),n},buildObjectToIndex:function(e,t){var a=[];return Object.keys(t).forEach((function(i){if(e.includes(i)){var n=t[i];a.push({Name:n.Name,Type:n.Type,SixWTag:n.SixWPredicate&&n.SixWPredicate.length>0?n.SixWPredicate:"",Parametric:"Yes"==n.Indexation?"true":"false",dimPresent:!!(n.Dimension&&n.Dimension.length>0)})}})),a},addNewAttrsToGridView:function(e,i,r,l,s,o){var u=this,d=!1;Object.keys(i).forEach((function(n){if(e.includes(n)||o&&1==o){var c=i[n],p=new t({label:c.Name,icons:[a.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],grid:u.buildGrid(c,s)});if(r.treeDocument.addRoot(p,void 0),l&&UWA.is(l,"function")){var m=r.layout.getCellsFromNodeModel(p),g=r.layout.getCellCoordinatesAt(m[0]),f=r.layout.getCellIDFromCoordinates(g),h=r.getCellInfosAt(f);l({},h)}else d=!0}})),d&&(n.getContent().RefreshProductStructure=!0,n.getContent().loadContentAndSelect())},buildGrid:function(e,t){var a="";e.AuthorizedValues&&e.AuthorizedValues.length>0&&(a=e.AuthorizedValues.join(","));var n="";e.Dimension_nls?(n=e.Dimension_nls,e.ManipulationUnit_nls&&(n+="("+e.ManipulationUnit_nls+")")):e.Dimension&&(n=e.Dimension,e.ManipulationUnit&&(n+="("+e.ManipulationUnit+")"));var r="";if(e.SixWPredicate_nls&&e.SixWPredicate_nls.length>0){let t=e.SixWPredicate_nls.split(":");r=1==t.length?t[0]:t[1]}var l=e.Name;e.NameNLS&&(l=e.NameNLS[widget.lang]?e.NameNLS[widget.lang]:e.NameNLS.en);var s=e.Default;"Date"==e.Type&&(s=e.Default_display);return t?{Name:e.Name,"ds6w:label":e.Name,Description:e.description?e.description:"",Type:i[e.Type],DefaultValue:s||"",hasDefault:e.HasDefault&&1==e.HasDefault?i.HasDefault_TRUE:i.HasDefault_FALSE,Dimension:e.Dimension,prefUnit:e.ManipulationUnit,isInDico:i.IS_IN_DICO_TRUE,Predicates:r,AuthorizedValues:a,IsMultivalue:e.MultiValuated&&"Yes"==e.MultiValuated?i.Multivalue_TRUE:i.Multivalue_FALSE,IsMultiline:e.MultiLine&&"Yes"==e.MultiLine?i.Multiline_TRUE:i.Multiline_FALSE,attrIsParametric:e.Indexation&&"Yes"==e.Indexation?i.INDEXATION_YES:i.INDEXATION_NO,nls_DE:e.NameNLS&&e.NameNLS.de?e.NameNLS.de:"",nls_EN:e.NameNLS&&e.NameNLS.en?e.NameNLS.en:"",nls_FR:e.NameNLS&&e.NameNLS.fr?e.NameNLS.fr:"",nls_JA:e.NameNLS&&e.NameNLS.ja?e.NameNLS.ja:"",nls_KO:e.NameNLS&&e.NameNLS.ko?e.NameNLS.ko:"",nls_RU:e.NameNLS&&e.NameNLS.ru?e.NameNLS.ru:"",nls_ZH:e.NameNLS&&e.NameNLS.zh?e.NameNLS.zh:"",values:{isInDico:"true",hasDefault:e.HasDefault,type:e.Type}}:{attrName:e.Name,attrTitle:l,attrDesc:e.description?e.description:"",attrKind:i[e.Type],attrDefault:s||"",attrHasDefault:e.HasDefault&&1==e.HasDefault?i.HasDefault_TRUE:i.HasDefault_FALSE,attrDim:n,attrPredi:r,attrAuthorizedValues:a,attrMinimum:"",attrMaximum:"",attrIsMultivalue:e.MultiValuated&&"Yes"==e.MultiValuated?i.Multivalue_TRUE:i.Multivalue_FALSE,attrIsParametric:e.Indexation&&"Yes"==e.Indexation?i.INDEXATION_YES:i.INDEXATION_NO,attrIsInDico:i.IS_IN_DICO_TRUE,attrSel:!0}}})})),define("DS/IPClassificationAttributes/dataprovider/DataProvider",["UWA/Class","UWA/Promise","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassificationAttributes/utils/AlertBox","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/IPClassificationAttributes/utils/AttributesUtil","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,a,i,n,r,l,s,o){"use strict";var u={},d={};return e.singleton({init:function(){this._parent({}),this.Dimensions={},this.Predicates={},this.Dictionary={},u=JSON.parse(l)},isGlobalAttributeTab:function(){return 1==o.getWidgetData().currentWidgetTab},upgradeClassAttributes:function(e){var t=n.upgradeClassAttributes.bind(n),a={timeout:5e5,method:"POST",data:JSON.stringify(e)};return this._sendRequest(t,a)},updateAttributeInfos:function(e){var t=n.updateAttributeInfos.bind(n),a={timeout:5e5,method:"POST",data:JSON.stringify(e)};return this._sendRequest(t,a)},reloadCache:function(){var e=n.reloadCache.bind(n);return this._sendRequest(e,{timeout:6e4,method:"GET"})},getPredicates:function(e){var a=this;if(!a.Predicates[e.tenantUrl]){a.Predicates[e.tenantUrl]={ready:t.deferred()};var r=n.getPredicates.bind(n);a._sendRequest(r,{timeout:6e4,method:"GET",mappable:!0}).then((function(t){var i={};null!=t&&(t="string"==typeof t?JSON.parse(t):t,Object.keys(t).forEach((function(e){var a={};null!=t[e].properties&&t[e].properties.forEach((function(e){var t=e.dataType,i=t.substring(t.lastIndexOf("#")+1);i=i.includes("date")?"date":i,a[i]||(a[i]=[]),a[i].push(e)})),Object.keys(a).forEach((function(e){a[e].sort((function(e,t){return e.label<t.label?-1:e.label>t.label?1:0}))})),i[t[e].label]=a}))),a.Predicates[e.tenantUrl].ready.resolve(i),console.info("Predicates loaded")}),(function(t){console.log("Unable to get Predicates : "),console.log(t),a.Predicates[e.tenantUrl].ready.reject(i.get("FAILED_TO_FETCH_PREDICATES")),delete a.Predicates[e.tenantUrl]}))}return a.Predicates[e.tenantUrl].ready},getDimensions:function(e){var a=this;if(!a.Dimensions[e.tenantUrl]){a.Dimensions[e.tenantUrl]={ready:t.deferred()};var r=n.getDimensionsInfos.bind(n);a._sendRequest(r,{timeout:6e4,method:"GET"}).then((function(t){t="string"==typeof t?JSON.parse(t):t,a.Dimensions[e.tenantUrl].ready.resolve(t),console.info("Dimensions loaded")}),(function(t){console.info("Dimensions load : failed"),console.log(t),a.Dimensions[e.tenantUrl].ready.reject(i.get("FAILED_TO_FETCH_DIMENSIONAL_ATTRIBUTES")),delete a.Dimensions[e.tenantUrl]}))}return a.Dimensions[e.tenantUrl].ready},setSavedNlsRanges:function(e,t){e?d[e]=t:d={}},getSavedNlsRanges:function(e){return d[e]?d[e]:{}},updateClassAttributes:function(e){var t=n.updateClassAttributes.bind(n),a={timeout:5e5,method:"POST",type:"json",package:u.package_name,data:JSON.stringify(e)};return this._sendRequest(t,a)},attributeDeleteCheck:function(e){var t=n.attributeDeleteCheck.bind(n),a={timeout:5e5,method:"POST",type:"json",data:JSON.stringify(e)};return this._sendRequest(t,a)},removeClassificationInterfaces:function(e){var t=n.removeClassificationInterfaces.bind(n),a={timeout:5e5,method:"POST",type:"json",data:JSON.stringify(e)};return this._sendRequest(t,a)},restoreSybolicNames:function(e){var t=n.restoreSybolicNames.bind(n),a={timeout:5e5,method:"POST",type:"json",package:u.package_name,data:JSON.stringify(e)};return this._sendRequest(t,a)},deleteClassAttributes:function(e){var t=n.deleteAttributes.bind(n),a={timeout:5e5,method:"POST",type:"json",package:u.package_name,data:JSON.stringify(e)};return this._sendRequest(t,a)},checkIfSymbolicNameExists:function(e){var t=n.checkIfSymbolicNameExists.bind(n),a={timeout:5e5,method:"POST",type:"json",data:JSON.stringify(e)};return this._sendRequest(t,a)},createClassificationAttributes:function(e){var t=n.createAttributes.bind(n),a={timeout:5e5,method:"POST",type:"json",package:u.package_name,data:JSON.stringify(e)};return this._sendRequest(t,a)},launchExport:function(){console.log("launchExporProcess");var e=JSON.parse(l),t=n.launchExport.bind(n),a={method:"GET",type:"blob",package:e.package_name,headers:{Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang}};return this._sendRequest(t,a)},launchImport:function(e){if(console.log("launchImportProcess"),e.type.match(/application\/x-zip-compressed/)){var t=n.launchImport.bind(n),a=new FormData;a.append("ClassificationAttributeszip",e,e.name);var l={method:"POST",type:"multipart/form-data",package:u.package_name,data:a,headers:{Accept:"multipart/form-data"}};return this._sendRequest(t,l)}this.userMessaging.add({className:"error",message:i.importBadFileExtension}),r.createAlertBox({nls:"importBadFileExtension"}).inject(l.headerDiv)},massupdateAttributeInfos:function(e){if(console.log("Updating attribute info"),e.type.match(/application\/x-zip-compressed/)){var t=new FormData;t.append("ClassificationAttributeszip",e,e.name);var a=n.massupdateAttributeInfos.bind(n),l={method:"POST",type:"multipart/form-data",package:u.package_name,data:t,headers:{Accept:"multipart/form-data"}};return this._sendRequest(a,l)}this.userMessaging.add({className:"error",message:i.importBadFileExtension}),r.createAlertBox({nls:"importBadFileExtension"}).inject(l.headerDiv)},_sendRequest:function(e,t){return new Promise((function(n,r){a.initURLSAsync().then((function(){var l={timeout:18e5,tenant:a.getTenantId(),securityContextRequired:!0,headers:{"Content-Type":"application/json"}},s=UWA.extend(l,t);t.headers&&(s.headers=UWA.extend(l.headers,t.headers)),s.onComplete=function(e){n(e)},s.onFailure=function(e,t){console.log("Request failled"),console.log(e),console.log(t);var a="";try{if("DictionaryException"in(t="string"==typeof t?JSON.parse(t):t)){const e=t.DictionaryException,{Status:n,Message:r}=e;a=n.contains("403")&&r.contains("forbidden")?i.OperationForbiden:t.DictionaryException.Message}else a=i.Internal_Error}catch(e){a=i.Internal_Error}r(a)},s.onTimeout=function(e,t){r({type:"timeout",error:e,data:t})},e(s)}))}))}})})),define("DS/IPClassificationAttributes/views/AttrRangeCreateForm",["DS/UIKIT/Modal","DS/UIKIT/Input/Text","DS/IPClassificationAttributes/utils/AlertBox","DS/IPClassificationAttributes/utils/AttributesUtil","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes"],(function(e,t,a,i,n){function r(e,t){var a={};return a.en=t("en",e.en,n.englishNLS),a.fr=t("fr",e.fr,n.frenchNLS),a.de=t("de",e.de,n.germanNLS),a.ja=t("ja",e.ja,n.japeneseNLS),a.ko=t("ko",e.ko,n.koreanNLS),a.ru=t("ru",e.ru,n.russianNLS),a.zh=t("zh",e.zh,n.chineseNLS),UWA.merge(a,e)}function l(e){if(!(this instanceof l))throw new TypeError("AttrRangeCreateForm constructor cannot be called as a function.");var t=this;this.options=UWA.extend({onShow:function(){},onHide:function(){},onSave:function(e){return!0},onError:function(e){}},e),this.nlsRange=e.nlsRange||{},this.editMode=e.editMode,this.searchOpen=!1,this.rangeFromDico=e.rangeFromDico,this._rangeInit=e.rangeList.map((function(e){return r({value:e},(a=>(t.nlsRange[e]||{})[a]||""))})),this._rangeEdit=this._rangeInit.map((function(e){return r(e,t.getNLSInput)}))}return l.prototype={constructor:l,getNLSRange:function(){return this._rangeEdit.reduce((function(e,t){return e[t.value]=r(t,((e,t)=>t.value)),e}),{})},getNLSInput:function(e,t,a){return UWA.createElement("input",{type:"text",class:"form-control",value:t,"data-init":t})},getTableDataElement:function(e){return UWA.createElement("td",{colspan:"1",align:"left",width:e.width})},getTableHeaderElement:function(e){var t=UWA.createElement("p",{text:e.headerName,class:""}),a=UWA.createElement("th",{colspan:"1",align:"left",width:e.width,"white-space":"nowrap",overflow:"hidden",id:e.headerId});return t.inject(a),a},getTable:function(e,a){var i=this,l=UWA.createElement("div",{class:"tableDiv"}).inject(e);l.setStyle("height","300px"),l.setStyle("overflow-x","auto");var s=UWA.createElement("table",{class:"table",id:"attrTable"}).inject(l);s.setStyle("max-width","unset"),s.setStyle("table-layout","fixed");var o=UWA.createElement("thead",{class:"attrthead",id:"attrthead"}).inject(s),u=UWA.createElement("tr").inject(o);u.setStyle("background","whitesmoke"),u.setStyle("position","sticky"),u.setStyle("top","0");var d=this.getTableHeaderElement({headerName:n.attrRangeTableHeader,width:"250px",headerId:"nameColumn"}).inject(u),c=(r({},(function(e,t,a){return i.getTableHeaderElement({headerName:a,width:"250px",headerId:"Trans"+e.toUpperCase()}).inject(u)})),UWA.createElement("tbody",{class:"attrtbody",id:"attrtbody"}).inject(s)),p=d.getElementsByTagName("p")[0];p.setStyle("cursor","pointer");var m=UWA.createElement("a",{class:"fonticon fonticon-search"});m.inject(p),m.setStyle("text-decoration","none"),m.setStyle("padding-left","5px");var g=new t({});g.inject(d),g.elements.input.setStyle("display","none");var f=[];function h(e){var t=g.getValue().toUpperCase(),a=e.getElementsByTagName("td")[0];a&&a.firstChild.value.toUpperCase().startsWith(t)?e.style.display="":e.style.display="none"}return m.onclick=function(){this.searchOpen?(g.elements.input.setStyle("display","none"),this.searchOpen=!1):(g.elements.input.setStyle("display","inline-block"),this.searchOpen=!0)},g.elements.input.onkeyup=function(){f.forEach(h)},function(e){return f.forEach((e=>e.destroy())),f=e.map((function(e,n){var l=UWA.createElement("tr").inject(c);return new t({id:"range_"+n,value:e.value}).inject(i.getTableDataElement({width:"250px"}).inject(l)).setDisabled(!0),r(e,(function(e,t){t.id="NLSValue_"+e+"_"+n,t.disabled=!a,t.inject(i.getTableDataElement({width:"250px"}).inject(l))})),h(l),l}))}},getTextRange:function(e){var a=new t({id:"rangeInput"});return a.elements.input.setStyle("margin-bottom","10px"),a.CustomValidate=function(){let t=!0;if("String"==e.attrType||"string"==e.attrType){this.getValue().split(";").forEach(((e,a)=>{e=e.trim();var i=new RegExp("^[a-zA-Z0-9]+$");e.length>0&&!i.test(e)&&(t=!1)}))}else if("Integer"==e.attrType||"integer"==e.attrType){this.getValue().split(";").forEach(((e,a)=>{e=e.trim();var i=new RegExp("^[-+]?[0-9]+$");e.length>0&&!i.test(e)&&(t=!1)}))}else if("Double"==e.attrType||"double"==e.attrType||"real"==e.attrType){this.getValue().split(";").forEach(((e,a)=>{e=e.trim();var i=new RegExp("^[-+]?\\d+(\\.\\d+)?$");e.length>0&&!i.test(e)&&(t=!1)}))}return t?this.elements.input.style.borderColor=null:this.elements.input.setStyle("border-color","#EA4F37"),t},a.onChange=function(){var t=[],a=e.onChange(this.getValue(),t),i=t.reduce(((e,t)=>e&&t.fixed),!0);this.setValue(a),this.elements.input.style.borderColor=i?null:"#EA4F37"},a},formModal:function(t){var a=UWA.createElement("div",{class:"global-div"}),i=(UWA.createElement("nav",{class:"tab tab-pills",id:"the-forms"}).inject(a),UWA.createElement("h4",{text:n.attrRangeTableTitle}).inject(a),new e({className:"fancy",visible:!0,closable:!0,header:a,body:t.form,footer:"<button type='button' id='SaveButton' class='btn btn-primary'>"+UWA.String.escapeHTML(n.attrRangeTableClose)+"</button><button type='button' id='CancelBtn' class='btn btn-default'>"+UWA.String.escapeHTML(n.attrRangeTableCancel)+"</button> ",renderTo:t.container,events:{onHide:function(){UWA.log("the Modal Closed2"),i.destroy(),t.onHide()},onShow:function(){t.onShow(),UWA.log("the Modal shown2")}}}));return t.editMode||(i.getFooter().getElement("#SaveButton").hidden=!0,i.getFooter().getElement("#CancelBtn").hidden=!0),i.getFooter().getElement("#SaveButton").addEvent("click",(function(){t.onSave()&&i.hide()})),i.getFooter().getElement("#CancelBtn").addEvent("click",(function(){t.onCancel()&&i.hide()})),i.elements.wrapper.setStyle("width","800px"),i},updateRangeList:function(e){var t=this;this._rangeEdit=e.map((function(e){var a=t._rangeInit.find((t=>t.value==e))||r({value:e},(e=>""));return t._rangeEdit.find((t=>t.value==e))||r(a,t.getNLSInput)}))},launchPanel:function(e){let t=this,n=e.editMode||this.editMode,l=e.attrName||this.options.attrName;UWA.log("add_type action");var s=UWA.createElement("div",{id:"myContent"}),o=UWA.createElement("div",{id:"got-tab-sample",class:"tab"});if(o.setStyle("justify-content","center"),o.inject(s),l){var u=UWA.createElement("h4");u.inject(o);var d=UWA.createElement("span",{class:"badge font-3dsregular badge-default",text:l});d.setStyle("padding-left","50px"),d.setStyle("padding-right","50px"),d.setStyle("padding-top","5px"),d.setStyle("padding-bottom","5px"),d.inject(u)}var c=this._rangeInit.map((e=>e.value)).join(";");function p(n,r){var l=i.checkRange(t.options.attrType,c,n,t.options.rangeFromDico,r,e.defaultValue);return r.reduce(((e,t)=>e&&t.fixed),!0)&&(t.updateRangeList(l),g(t._rangeEdit)),r.length&&(a.createAlertBox(r).inject(f.elements.header),t.options.onError(r)),l.join(";")}var m=this.getTextRange({attrType:this.options.attrType,onError:this.options.onError,onChange:p}),g=this.getTable(s,n),f=this.formModal({form:s,editMode:n,container:this.options.container,onShow:this.options.onShow,onHide:this.options.onHide,onSave:function(){var e=[],a=p(m.getValue(),e);return!!(e.reduce(((e,t)=>e&&t.fixed),!0)&&m.CustomValidate()&&t.options.onSave(a))&&(m.setValue(a),!0)},onCancel:function(){return t._rangeEdit.forEach((function(e){r(e,(function(e,t){return t.value=t.dataset.init,t}))})),m.setValue(h),t.updateRangeList(c.split(";")),g(t._rangeEdit),!0}}),h=p(this._rangeEdit.map((e=>e.value)).join(";"),[]);m.parent=f,m.setDisabled(!n),m.inject(o),m.setValue(h),g(this._rangeEdit)},enable:function(){this.editMode=!0},disable:function(){this.editMode=!1}},l})),define("DS/IPClassificationAttributes/views/ToolsLayoutView",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Popover","DS/UIKIT/Input/Button","DS/UIKIT/Alert","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/UIKIT/Mask","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/ZipUtils","DS/IPClassifyUtil/IPClassifyAlert","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/IPClassificationAttributes/utils/AttributesUtil","DS/ClassificationEditor/utils/ClassificationEditorcontrol","css!DS/IPClassificationAttributes/assets/css/mycss.css"],(function(e,t,a,i,n,r,l,s,o,u,d,c,p,m){"use strict";var g;return{init:function(t){console.log("ToolsLayoutView::init"),console.log(t),t=e.clone(t||{},!1),this,this.userMessaging=null,this.IsInPROD=!1,this.listOfCollabSpace=[],this.divUpdateIndexHistory=null,this.updateButton=null,this.importButton=null,this.exportButton=null,this.importBRButton=null,this.toolsScroller=null,this.selectCollabSpace=null,this.fileController=null,this.fileBRController=null,this.upgradeButton=null,this.render()},setup:function(e){console.log("ToolsLayoutView::setup"),console.log(e);console.log(this),this.render()},render:function(){console.log("ToolsLayoutView::render");return this.contentDiv=e.createElement("div",{id:"mainToolsDiv"}),this.userMessaging=new n({className:"Tools-alert",closable:!0,visible:!0,renderTo:document.body,autoHide:!0,hideDelay:2e3,messageClassName:"warning"}),console.log("this.container"),console.log(this.container),this},formModal:function(e,a,i){var n=this,l=new t({className:"fancy",visible:!0,closable:!0,header:i,body:n.contentDiv,footer:"<button type='button' id='CloseButton' class='btn btn-primary'>"+r.close+"</button>",renderTo:a,events:{onHide:function(e){console.log("the Modal Closed"),l.destroy()},onShow:function(){console.log("the Modal shown"),console.log(n.contentDiv)}}});return l.getFooter().getElement("#CloseButton").addEvent("click",(function(){l.destroy()})),l.elements.wrapper.setStyle("width","800px"),l.elements.wrapper.setStyle("height","1800px"),l},buildMenu:function(t){console.log("ToolsLayoutView::buildMenu"),this.init({});var n=this,l=t.container;"DEV".contains("DEV")||(this.IsInPROD=!0),this.listOfCollabSpace="Scs";var f=e.createElement("div",{class:"global-div"});e.createElement("h4",{text:r.modalClAttributesToolsHeader}).inject(f);var h=e.createElement("div",{id:"to-scroll-tools"}),b=e.createElement("div",{class:"container-fluid"}).inject(h),v=e.createElement("div",{id:"ToolsGridContent"}).inject(b),y=e.createElement("div",{class:"ToolsLabel",id:"ToolsUpgradeLabel"}).inject(v);e.createElement("p",{text:r.upgrade,class:""}).inject(y);var A=e.createElement("div",{class:"",id:"ToolsLineSep"}).inject(v);e.createElement("hr",{class:"lineSep"}).inject(A);var S=e.createElement("div",{class:"ToolsLabel",id:"ToolsImportLabel"}).inject(v);e.createElement("p",{text:r.import,class:""}).inject(S);var D=e.createElement("div",{class:"ToolsLabel",id:"ToolsExportLabel"}).inject(v);e.createElement("p",{text:r.export,class:""}).inject(D),new a({target:y,trigger:"hover",animate:"true",position:"top",body:r.upgradeToolTip,title:""}),new a({target:S,trigger:"hover",animate:"true",position:"top",body:r.importToolTip,title:""}),new a({target:D,trigger:"hover",animate:"true",position:"top",body:r.exportToolTip,title:""});var N=e.createElement("div",{class:"ToolsDivButton",id:"ToolsUpgradeButton"}).inject(v);this.upgradeButton=new i({className:"default  ToolsButton",icon:"tools",attributes:{title:r.upgradeButton},events:{onClick:function(){console.log("ToolsLayoutView::launch Classification Attributes Upgrade");var e=JSON.parse(c),t=p.getDataToUpgrade();t&&0!=t.length?(s.addComponentsToLoad("global",{attributeTools:r.msg_deleteattr}),o.upgradeClassAttributes({interface:e.interface_name,attributes:t}).then((function(e){n.userMessaging.add({className:"success",message:r.upgradeSuccess}),m.getContent().RefreshProductStructure=!0,m.getContent().loadContentAndSelect(),s.removeComponentToLoad("global","attributeTools")}),(function(e){s.removeComponentToLoad("global","attributeTools");var t=r.upgardeFail;null!=e&&0!==e.length&&(t+=": "+e),n.userMessaging.add({className:"error",message:t})}))):d.displayNotification({message:r.noAttributeToUpgrade,className:"warning"})}}}).inject(N);var T=e.createElement("div",{id:"ToolsBrowseImportFile",class:"ToolsDivBrowseFile"}).inject(v);this.fileController=new e.Controls.Input.File({attributes:{id:"ImportFileInput",accept:"application/x-zip-compressed",placeHolder:r.importAttributesPanelPLHolder},className:"ToolsImportFileInput xml-file-input",events:{onChange:function(e){var t=JSON.parse(c);0===document.getElementById("ImportFileInput").files.length&&e.odtTarget&&(e=e.odtTarget),1===e.target.files.length?(n.importButton.setDisabled(!1),u.unzip(e.target.files[0]).then((function(e){if(g=e,null==e)n.importButton.setDisabled(!0),d.displayNotification({message:r.importAttributesPanelPLHolder,className:"error"});else{n.importButton.setDisabled(!1);var a={};Object.keys(e).forEach((function(i){"Dictionary"==i?a=e[i].Interfaces[t.interface_name].Attributes:e[i].Dictionary&&(a=e[i].Dictionary.Interfaces[t.interface_name].Attributes)})),0==Object.keys(a).length&&(n.importButton.setDisabled(!0),d.displayNotification({message:r.noAttributeToImport,className:"error"}))}}))):n.importButton.setDisabled(!0)}}}).inject(T);var C=e.createElement("div",{class:"ToolsDivButton",id:"ToolsImportButton"}).inject(v);this.importButton=new i({className:"default  ToolsUploadButton",icon:"import-multiple",attributes:{title:r.importButton},events:{onClick:function(e){console.log("ToolsLayoutView::launch Classification Attributes Import"),s.addComponentsToLoad("global",{attributeTools:r.msg_deleteattr});var a=document.getElementById("ImportFileInput");0===a.files.length&&e.odtTarget&&(a=e.odtTarget),a&&(a.files[0].type.match(/application\/x-zip-compressed/)?o.launchImport(a.files[0]).then((function(e){o.massupdateAttributeInfos(a.files[0]).then((function(e){var a=JSON.parse(c);if(null!=g&&Object.keys(g).length>0){var i={};Object.keys(g).forEach((function(e){"Dictionary"==e?i=g[e].Interfaces[a.interface_name].Attributes:g[e].Dictionary&&(i=g[e].Dictionary.Interfaces[a.interface_name].Attributes)})),p.addNewAttrsToGridView([],i,t.grid,t.changeGridObjects,o.isGlobalAttributeTab(),!0)}s.removeComponentToLoad("global","attributeTools"),console.log("Launch import complete"),n.userMessaging.add({className:"success",message:r.importSuccess})}),(function(e){s.removeComponentToLoad("global","attributeTools"),console.log("Failure to import Classification Attributes");var t=r.importFail;null!=e&&0!==e.length&&(t+=": "+e),n.userMessaging.add({className:"error",message:t})}))}),(function(e){s.removeComponentToLoad("global","attributeTools"),console.log("Failure to import Classification Attributes");var t=r.importFail;null!=e&&0!==e.length&&(t+=": "+e),n.userMessaging.add({className:"error",message:t})})):n.userMessaging.add({className:"error",message:r.importBadFileExtension}))}}}).inject(C),this.importButton.setDisabled(!0);var I=e.createElement("div",{class:"ToolsDivButton",id:"ToolsExportButton"}).inject(v);this.exportButton=new i({className:"default  ToolsButton",icon:"export-multiple",attributes:{title:r.exportButton},events:{onClick:function(){p.haveDataToExport()?(console.log("ToolsLayoutView::launch Classification Attributes Export"),s.addComponentsToLoad("global",{attributeTools:r.msg_deleteattr}),o.launchExport().then((function(e){s.removeComponentToLoad("global","attributeTools");var t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download="ClassificationAttributesExport.zip",t.dispatchEvent(new MouseEvent("click"))}),(function(e){s.removeComponentToLoad("global","attributeTools");var t=r.exportFail;null!=e&&0!==e.length&&(t+=": "+e),n.userMessaging.add({className:"error",message:t})}))):d.displayNotification({message:r.noAttributeToExport,className:"warning"})}}}).inject(I),s.removeComponentToLoad("global","attributeTools"),h.inject(this.contentDiv),this.formModal(h,l,f)},destroy:function(){console.log("ToolsLayoutView::destroy"),this.stopListening(),this._parent()}}})),define("DS/IPClassificationAttributes/utils/EventHandler",["UWA/Class","UWA/Promise","DS/IPClassificationAttributes/utils/AlertBox","DS/IPClassificationAttributes/utils/TableBuilder","DS/IPClassificationAttributes/views/AttrRangeCreateForm","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassificationAttributes/utils/AttributesUtil","DS/WidgetServices/WidgetServices","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,a,i,n,r,l,s,o,u,d,c,p,m){"use strict";var g=null,f=new Set,h=new Set,b={},v=[],y=e.singleton({init:function(){this._parent({}),b=JSON.parse(d)},setAttributeNameList:function(e){e.forEach((function(e){v.push(e.name)}))},hasDefaultToggled:function(e,t,a){var i=e.target,n=t.lines[a].defaultValue;if(i.checked){n.setDisabled(!1);var r=t.lines[a].multiValueField;r.isChecked()&&r.uncheck()}else{n.setDisabled(!0);try{n.setValue("")}catch(e){n.resetInput()}}},asEnteredUnitToggle:function(e,t,a){e.target,t.lines[a].preferedUnitValue},multiValueToggled:function(e,t,a){var i=e.target,n=t.lines[a].hasDefaultField;i.checked&&!n.isChecked()||n.elements.input.click()},parseInputValue:function(e,t){var a=e.target;"Integer"==t.attrType&&a.value.length>0&&(a.value=parseInt(a.value),a.value>2147483647?a.value=2147483647:a.value<-2147483647&&(a.value=-2147483647)),"Double"!=t.attrType&&"DoubleWithDim"!=t.attrType||a.value.length>0&&(a.value=parseFloat(a.value))},checkInputValue:function(e,t){var a="";if("Integer"==t.attrType&&(a="^[-+]?\\d+"),"Double"!=t.attrType&&"DoubleWithDim"!=t.attrType||(a="^[-+]?\\d+(\\.)?(\\d{1,6})?"),""==a)return!0;var i=e.target,n=new RegExp(a+"$");if(i.value.length>1&&!n.test(i.value)){var r=new RegExp(a),l=i.value.match(r);i.value=null!=l?l[0]:""}else 1==i.value.length&&"-"!=i.value&&"+"!=i.value&&isNaN(i.value)&&(i.value="")},dimUnSelected:function(e,t,a){e.lines[t].preferedUnitValue.reset()},dimSelected:function(e,t,a){var i=e.lines[t].preferedUnitValue;i.reset();var n=e.Units[a.value]?e.Units[a.value]:[],r=[];n.forEach((e=>{r.push({value:e.Name,label:e.NLSName})})),i.datasets[0].items.length=0,i.addItems(r,i.datasets[0])},predUnSelected:function(e,t,a){if("String"==e.attrType||"Boolean"==e.attrType||"Date"==e.attrType){var i=e.lines[t].displayIn6WTags;i&&(i.setValue(1),i.disable())}},predSelected:function(e,t,a){var i=document.querySelector("#"+e.id+t),n=document.querySelector("#"+e.id+t+"_inputHidden");if(n||((n=UWA.createElement("input",{id:e.id+t+"_inputHidden"})).hidden=!0,n.inject(i)),n.value=a.value,"String"==e.attrType||"Boolean"==e.attrType||"Date"==e.attrType||"Integer"==e.attrType||"Double"==e.attrType){var r=e.lines[t].displayIn6WTags;r&&r.enable()}},isNameValid:function(e,t){var i=e.value,n=RegExp("^[a-zA-Z][a-zA-Z0-9]+$");if(i.length>0&&!n.test(i)){f.add(e.id),e.setStyle("border-color","#EA4F37");var r="ErrCreateAttrNameIncorrect";return isNaN(i[0])||(r="ErrCreateAttrNameStartWithNumber"),a.createAlertBox({nls:r}).inject(t),!1}return null!=e.style.borderColor&&(e.style.borderColor=null),f.has(e.id)&&f.delete(e.id),!0},isNameUnique:function(e,t,i){return t.some((function(t,a){var i=t.nameField.getValue();return!e.id.endsWith(a)&&i==e.value}))?(f.add(e.id),e.setStyle("border-color","#EA4F37"),a.createAlertBox({nls:"ErrCreateAttrNameShouldBeUnique"}).inject(i),!1):(null!=e.style.borderColor&&(e.style.borderColor=null),f.has(e.id)&&f.delete(e.id),!0)},validateNameField:function(e,t){var a=e.target;y.isNameValid(a,t.headerDiv)&&a.value.length>0&&y.isNameUnique(a,t.lines,t.headerDiv),document.querySelector("#SaveButton").disabled=f.size>0||h.size>0},toggleTo:function(e,t){let a;switch(e,e){case 0:a=document.querySelector("#nameColumn");break;case 1:a=document.querySelector("#authorizedValueColumn"),null==a&&(a=document.querySelector("#defaultValueColumn"));break;case 2:a=document.querySelector("#TransEN")}null!=a&&a.scrollIntoView({behavior:"smooth",inline:"start"})},hideModal:function(e,t){console.log("the Modal Closed"),"string"==typeof t&&"HideForRangeModal"===t?(e.isVisible=!1,e.elements.container.setStyle("display","")):e.destroy()},showModal:function(e,t){g=e,console.log("the Modal shown");var a=new IntersectionObserver((function(e){e.sort((function(e,t){return e.intersectionRatio<t.intersectionRatio?1:e.intersectionRatio>t.intersectionRatio?-1:0}));var a=document.querySelector("#got-tab-sample");Array.isArray(e)&&e.forEach((function(e){if(e.intersectionRatio>=.98){let i=-1;if(-1!=t)i=t,t=-1;else switch(e.target.id){case"nameColumn":i=0;break;case"authorizedValueColumn":case"defaultValueColumn":i=1;break;case"TransDE":case"TransZH":i=2}a.getElementsByClassName("active")[0].toggleClassName("active"),a.getChildren()[i].toggleClassName("active")}}))}),{threshold:[1]});null!=document.querySelector("#authorizedValueColumn")?a.observe(document.querySelector("#authorizedValueColumn")):a.observe(document.querySelector("#defaultValueColumn")),a.observe(document.querySelector("#nameColumn")),a.observe(document.querySelector("#TransDE")),a.observe(document.querySelector("#TransZH"))},createAttributes:function(e){var t=e.modal,i=e.lines,n=e.attribute_type,l=t.getBody().getElements("tbody>tr"),u=v,d="",c=[];if(i.some(((e,t)=>{var a=e.nameField.getValue();return a&&c.push(a),0!=a.length&&(!!u.includes(a)&&(d=a,!0))})))return a.createAlertBox({nls:"ErrCreateAttrNameAlreadyTaken",NAME:d}).inject(e.header),!1;s.checkIfSymbolicNameExists({attributes:c}).then((function(u){if((u="string"==typeof u?JSON.parse(u):u)&&u.conflictingAttrNames){if(1==u.conflictingAttrNames.length)return a.createAlertBox({nls:"ErrCreateAttrNameAlreadyTaken",NAME:u.conflictingAttrNames.toString()}).inject(e.header),!1;if(u.conflictingAttrNames.length>1)return a.createAlertBox({nls:"ErrCreateAttrNamesAlreadyTaken",NAME:u.conflictingAttrNames.toString()}).inject(e.header),!1}var d=o.buildObjectToSend(l,i,n);if(console.log(d.Attributes),Object.keys(d.Attributes).length>0){var c=document.querySelector("#SaveButton");c.disabled=!0,m.getContent().getView().webUXLoader(!0,r.msg_newAttr),s.createClassificationAttributes(d).then((function(i){var n=(i="string"==typeof i?JSON.parse(i):i).Dictionary.Interfaces[b.interface_name].Attributes,l=Object.keys(n),u=o.buildObjectToIndex(l,d.Attributes);s.updateAttributeInfos(u).then((function(){t.destroy(),o.addNewAttrsToGridView(l,d.Attributes,e.grid,e.changeGridObjects,s.isGlobalAttributeTab()),m.getContent().getView().webUXLoader(!1)}),(function(t){m.getContent().getView().webUXLoader(!1),a.createAlertBox(r.updateAttributesInfosFail).inject(e.header),c.disabled=!1}))}),(function(t){m.getContent().getView().webUXLoader(!1);var i="";try{if(t.indexOf("Error: #1900005: Name")>-1&&t.indexOf("not unique")>-1){var n=t.indexOf("Error: #1900005: Name"),r=t.indexOf("not unique");i=(i=t.substring(n+21+1,r)).trim().length>0?i.replace("'",""):i}if(t.indexOf("Attribute'[")>-1&&t.indexOf("cannot be changed")>-1){n=t.indexOf("["),r=t.indexOf("]");i=t.substring(n+1,r)}}catch(i){a.createAlertBox(t).inject(e.header)}i.trim().length>0?a.createAlertBox({nls:"ErrCreateAttrNameAlreadyTaken",NAME:i.trim()}).inject(e.header):a.createAlertBox(t).inject(e.header),c.disabled=!1}))}}))},valuesClickAction:function(e){var t=this,a=e.context.nodeModel.options.grid.values.type,i=e.context.nodeModel.options.grid.Name,r=e.context.cellModel.label;l.getAuthorizedValuesNls({attribute:i,values:r,type:a,onComplete:function(t){var l=t="string"==typeof t?JSON.parse(t):t;if(!Object.keys(s.getSavedNlsRanges(i)).length>0&&l[i]&&l[i].AuthorizedValues){var o=t[i].rangeValuesNls;s.setSavedNlsRanges(i,o)}var u=r.split(",");u=(u=u.map((e=>e.trim()))).filter((function(e){return e.length>0}));var d=e.context.nodeModel.options.grid.DefaultValue,m=new n({rangeList:u,nlsRange:s.getSavedNlsRanges(i),attrName:i,attrType:a,container:widget.body.container,rangeFromDico:l[i]&&l[i].AuthorizedValues?l[i].AuthorizedValues:[],editMode:!0,onSave:function(t){var n={};m&&m._rangeEdit&&!m._rangeEdit||m._rangeEdit.forEach((function(e){n[e.value]={en:e.en.value,fr:e.fr.value,de:e.de.value,ja:e.ja.value,ko:e.ko.value,ru:e.ru.value,zh:e.zh.value,value:e.value}}));var r={en:e.context.nodeModel.options.grid.nls_EN,fr:e.context.nodeModel.options.grid.nls_FR,de:e.context.nodeModel.options.grid.nls_DE,ja:e.context.nodeModel.options.grid.nls_JA,ko:e.context.nodeModel.options.grid.nls_KO,ru:e.context.nodeModel.options.grid.nls_RU,zh:e.context.nodeModel.options.grid.nls_ZH},o=[];l[i]&&l[i].AuthorizedValues&&(o=l[i].AuthorizedValues.map((function(e){return"Double"==a||"double"==a||"real"==a?e.toString():e})));let u=!1,d=e.context.nodeModel.options.grid.DefaultValue,g=!1,f=d;null==f&&e.context.nodeModel._referenceValues&&e.context.nodeModel._referenceValues.hasOwnProperty("DefaultValue")&&(f=e.context.nodeModel._referenceValues.DefaultValue,g=!0);let h=!1;""==t&&o.length>0?h=!1:d&&!t.split(";").includes(d)&&(e.context.nodeModel.prepareUpdate(),e.context.nodeModel.setAttribute("DefaultValue",void 0),e.context.nodeModel.pushUpdate(),h=!0,u=!0),s.setSavedNlsRanges(i,n),c.publish({event:"/NLSRange/updated",data:{nlsRanges:n,authorizedValues:t,Name:i,nameNLS:r,attrType:a,originalRange:o,defaultValue:d,isDefaultValueSaveBlocked:u,defaultValueChanged:h}});let b=t.split(";");e.context.nodeModel.prepareUpdate(),e.context.nodeModel.setAuthorizedValuesFromForm=!0,e.context.nodeModel.setAttribute("AuthorizedValues",b.join(",")),e.context.nodeModel.pushUpdate(),g&&null!=f&&(e.context.nodeModel.resetDefaultValue=!0,e.context.nodeModel.prepareUpdate(),e.context.nodeModel.setAttribute("DefaultValue",f),e.context.nodeModel.pushUpdate());var v=p.get().options.views?p.get().options.views.datagridview:void 0;return v&&v.options.dgv.updateColumnView("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),!0},onHide:function(){}});m.updateRangeList(u),m.launchPanel({attrName:e.context.nodeModel.options.grid.Name,defaultValue:d})},onFailure:function(e){LibraryCommands._offProgressBar(),t.enable(),LibraryCommands._commonError("DeleteAttributes",Nls.msg_error_deleteClassAttributes,e)}})},iconClickAction:function(e,t,a){var i=e.srcElement,r=i.line.authorizedField.getValue().split(";");r=(r=r.map((e=>e.trim()))).filter((function(e){return e.length>0})),i.line.authorizedField.setValue(r.join(";"));var l,s=i.line.nameField.getValue();g.dispatchEvent("onHide","HideForRangeModal"),i.line.theRangeModal||(i.line.theRangeModal=new n({rangeList:[],attrName:s,attrType:t.attrType,container:t.container,parent:g,editMode:!0,onSave:(l=i.line,function(e){return l.authorizedField.setValue(e),l.authorizedField.dispatchEvent("onChange"),!0}),onHide:function(){g.show()}})),i.line.theRangeModal.updateRangeList(r),i.line.theRangeModal.launchPanel({attrName:s})},authorizedValuesChanged:function(e,t,n){var l="",s=!1,o=t.lines[n].authorizedField,u=o.getValue(),d=u.split(";");d=(d=d.map((e=>e.trim()))).filter((e=>e.length>0)),o.setValue(d.join(";")),u=d.join(";");var c=d.filter(((e,t)=>d.indexOf(e)==t)),p=d.filter(((e,t)=>d.indexOf(e)!=t));if(p.length>0&&(s=!0,l=r.get("attrRangeErrDupValue")+p.join(" - "),o.setValue(c.join(";"))),c.forEach(((e,a)=>{if(console.log(e),(e=e.trim()).length>0){var i="",n=null;"Double"==t.attrType?(n=new RegExp("^[-+]?\\d+(\\.\\d+)?$"),i="attrRangeErrDouble"):"Integer"==t.attrType?(n=new RegExp("^[-+]?[0-9]+$"),i="attrRangeErrInteger"):"String"==t.attrType&&(n=new RegExp("^[a-zA-Z0-9]+$"),i="attrRangeErrAlphanumeric"),null!=n&&(n.test(e)&&null!=o.elements.input.style.borderColor?o.elements.input.style.borderColor=null:(s=!0,l=r.get(i)))}})),s)h.add(o),o.elements.input.setStyle("border-color","#EA4F37"),a.createAlertBox(l).inject(t.headerDiv);else{h.has(o)&&h.delete(o);let e=t.lines[n].defaultValue.isDisabled();var m=t.lines[n].defaultValue.elements.container.getParent(),g=t.lines[n].defaultValue;if(t.lines[n].defaultValue.elements.container.remove(),c.length>0&&""!=u){var b={name:"Types",items:[]};"Integer"==t.attrType?c.sort((function(e,t){return e-t})):c.sort(),c.forEach((function(e){(e=e.trim()).length>0&&b.items.push({value:e})}));var v=i.createAutoCompleteField({placeholder:r.get("createAttrFieldDefaultValuePlaceholder"),datasets:b});t.lines[n].defaultValue=v,v.inject(m),v.validateWhenRangeIsDefined=function(e){if(this.isDisabled())return this.elements.inputContainer.style.borderColor=null,!0;let i=e.getValue(),n=this.getValue(),r=i.split(";");return r.length>0&&!r.includes(n)?(this.elements.inputContainer.setStyle("border-color","#EA4F37"),a.createAlertBox({nls:"attrDefaultValShouldBeOneAmongRangeVal"}).inject(t.headerDiv),!1):(this.elements.inputContainer.style.borderColor=null,!0)},e&&(v.resetInput(),v.setDisabled(!0))}else null!=t.lines[n].defaultValue&&(t.lines[n].defaultValue=g,t.lines[n].defaultValue.inject(m),t.lines[n].defaultValue.datasets=[],t.lines[n].defaultValue.resetInput&&t.lines[n].defaultValue.resetInput(),e&&(t.lines[n].defaultValue.setValue(""),t.lines[n].defaultValue.setDisabled(!0)))}var y=document.querySelector("#SaveButton");h.size>0||f.size>0?y.disabled=!0:y.disabled=!1}});return y})),define("DS/IPClassificationAttributes/views/AttrCreateForm",["DS/UIKIT/Modal","DS/UIKIT/Toggler","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/IPClassificationAttributes/utils/TableBuilder","DS/IPClassificationAttributes/utils/EventHandler"],(function(e,t,a,i,n){var r=[];return{createTabNavPanel:function(){var e=UWA.createElement("div",{id:"got-tab-sample",class:"tab"});return e.setStyle("justify-content","center"),UWA.createElement("a",{class:"tab-item",text:a.get("BasicsTab")}).inject(e),UWA.createElement("a",{class:"tab-item",text:a.get("ValuesTab")}).inject(e),UWA.createElement("a",{class:"tab-item",text:a.get("TranslationsTab")}).inject(e),new t({container:e,activeClass:"active",selected:0,events:{onToggle:function(e,t,a){n.toggleTo(t,0)}}}),e},formModal:function(t,i,l,s,o,u){var d=new e({className:"fancy",visible:!0,closable:!0,header:i,body:t,footer:"<button type='button' id='SaveButton' class='btn btn-primary'>"+a.get("Create")+"</button><button type='button' id='CancelBtn' class='btn btn-default'>"+a.get("Cancel")+"</button> ",renderTo:l,events:{onHide:function(e){n.hideModal(this,e)},onShow:function(){n.showModal(this,0)}}});return d.getFooter().getElement("#SaveButton").disabled=!0,d.getFooter().getElement("#SaveButton").addEvent("click",(function(){n.createAttributes({modal:d,lines:r,attribute_type:s,header:i,grid:o,changeGridObjects:u})})),d.getFooter().getElement("#CancelBtn").addEvent("click",(function(){d.destroy()})),d.elements.wrapper.setStyle("width","800px"),d},launchPanel:function(e){var t=e.container;_header=e.header;var l=UWA.createElement("div",{class:"global-div"}),s=UWA.createElement("div",{id:"myContent"});UWA.createElement("h4",{text:_header}).inject(l),UWA.createElement("nav",{class:"tab tab-pills",id:"the-forms"}).inject(l),this.createTabNavPanel().inject(s);var o=UWA.createElement("div",{class:"tableDiv",styles:{"overflow-x":"auto"},events:{onscroll:()=>{}}}).inject(s);let u=!1;(window.createDisplayAsEnteredAttribute||widget.createDisplayAsEnteredAttribute||window[0]&&window[0].createDisplayAsEnteredAttribute)&&(u=!0),u="DoubleWithDim"==e.attrType&&1==u;var d=[{visible:!0,headerId:"nameColumn",headerName:a.get("createAttrTableNameHeader")},{visible:!0,headerId:"predicateColumn",headerName:a.get("createAttrTablePredicateHeader")},{visible:!0,headerId:"displayIn6WTagsColumn",headerName:a.get("createAttrTableDisplayIn6WTagsHeader")},{visible:"String"==e.attrType||"Integer"==e.attrType||"Double"==e.attrType,headerId:"authorizedValueColumn",headerName:a.get("createAttrTableRangesHeader")},{visible:"DoubleWithDim"==e.attrType,headerId:"dimensionsValueColumn",headerName:a.get("createAttrTableDimensionHeader")},{visible:"DoubleWithDim"==e.attrType,headerId:"PreferendUnitValueColumn",headerName:a.get("createAttrTablePrefUnitHeader")},{visible:!0,headerId:"defaultValueColumn",headerName:"DoubleWithDim"===e.attrType?a.get("createAttrTableDefaultValueForDimHeader"):a.get("createAttrTableDefaultValueHeader")},{visible:u,width:"100px",headerId:"asEnteredUnitColumn",headerName:a.get("createAttrTableDisplayUnitAsEntered")},{visible:!0,width:"100px",headerId:"multiValueColumn",headerName:a.get("createAttrTableMultiValueHeader")},{visible:"String"==e.attrType,width:"100px",headerId:"multiLineColumn",headerName:a.get("createAttrTableMultilineHeader")},{visible:!0,width:"100px",headerId:"hasDefaultColumn",headerName:a.get("createAttrHasDefaultHeader")},{visible:!0,headerId:"TransEN",headerName:a.get("createAttrTableEnHeader")},{visible:!0,headerId:"TransFR",headerName:a.get("createAttrTableFrHeader")},{visible:!0,headerId:"TransDE",headerName:a.get("createAttrTableDeHeader")},{visible:!0,headerId:"TransJA",headerName:a.get("createAttrTableJaHeader")},{visible:!0,headerId:"TransKO",headerName:a.get("createAttrTableKoHeader")},{visible:!0,headerId:"TransRU",headerName:a.get("createAttrTableRuHeader")},{visible:!0,headerId:"TransZH",headerName:a.get("createAttrTableZhHeader")}],c={name:"Predicates",items:[]};if(e.predicates){var p=e.predicates;Object.keys(p).forEach((function(t){var a={label:t,items:[]},i=p[t];if(i){var n=i["DoubleWithDim"===e.attrType?"double":e.attrType.toLowerCase()];n&&Array.isArray(n)&&n.length>0&&(n.forEach((function(e){a.items.push({value:e.curi,label:e.label})})),c.items.push(a))}}))}var m={name:"Dimensions",items:[]},g={};if("DoubleWithDim"==e.attrType){var f=e.dimensions;f&&Array.isArray(f)&&f.length>0&&Object.keys(f).forEach((function(e){var t=f[e].Name,a=f[e].NLS;m.items.push({value:t,label:a}),g[t]=f[e].Units}))}var h=[{type:"text",visible:!0,fieldName:"nameField",id:"attrNameInput_",placeholder:a.get("createAttrNameFieldPLHolder"),onChange:n.validateNameField},{type:"autocomplete",visible:!0,fieldName:"predicateField",id:"predicateInput_",datasets:c,placeholder:a.get("createAttrFieldPredicatePlaceholder"),className:"autoCompletePredicate",attrType:e.attrType,onSelect:n.predSelected,onUnselect:n.predUnSelected},{type:"select",visible:!0,fieldName:"displayIn6WTags",id:"attrDisplayIn6WTagsInput_",disabled:!0,items:[{value:"No",label:a.get("createAttrFieldNoLabel"),selected:!0},{value:"Yes",label:a.get("createAttrFieldYesLabel")}]},{type:"chooser",visible:"String"==e.attrType||"Integer"==e.attrType||"Double"==e.attrType,fieldName:"authorizedField",id:"attrAutorizedValueInput_",className:"form-control",classIcon:"input-group-addon fonticon fonticon-language",onChange:n.authorizedValuesChanged,iconClickAction:n.iconClickAction,attrType:e.attrType,container:t},{type:"autocomplete",visible:"DoubleWithDim"==e.attrType,fieldName:"dimValue",id:"attrDimValueInput_",datasets:m,Units:g,placeholder:a.get("createAttrFieldDimensionPlaceholder"),className:"autoCompleteDim",onSelect:n.dimSelected,onUnselect:n.dimUnSelected},{type:"autocomplete",visible:"DoubleWithDim"==e.attrType,fieldName:"preferedUnitValue",id:"attrPreferedUnitValueInput_",placeholder:a.get("createAttrFieldPrefUnitPlaceholder"),className:"autoCompletePreferedUnit",datasets:{items:[]}},{type:"Date"==e.attrType?"date":"Boolean"==e.attrType?"select":"text",visible:!0,fieldName:"defaultValue",id:"attrDefaultValueInput_",placeholder:"Date"==e.attrType?a.get("createAttrFieldDateDefaultValuePlaceholder"):"",items:"Boolean"==e.attrType?[{value:"true",label:a.get("createAttrFieldTrueLabel")},{value:"false",label:a.get("createAttrFieldFalseLabel")}]:void 0,attrType:e.attrType,onInput:n.checkInputValue,onChange:n.parseInputValue},{type:"switch",visible:u,fieldName:"DisplayAsEntered",id:"attrAsEnteredInput_",value:"option1",width:"100px"},{type:"switch",visible:!0,fieldName:"multiValueField",id:"attrMultiValueInput_",value:"option1",width:"100px",onChange:n.multiValueToggled},{type:"switch",visible:"String"==e.attrType,fieldName:"multiLineField",id:"attrMultiLineInput_",value:"option1",width:"100px"},{type:"switch",visible:!0,fieldName:"hasDefaultField",id:"attrHasDefaultInput_",value:"option1",width:"100px",checked:!0,onChange:n.hasDefaultToggled},{type:"text",visible:!0,fieldName:"inputEN",id:"NLSValueEN",className:"form-control"},{type:"text",visible:!0,fieldName:"inputFR",id:"NLSValueFR",className:"form-control"},{type:"text",visible:!0,fieldName:"inputDE",id:"NLSValueDE",className:"form-control"},{type:"text",visible:!0,fieldName:"inputJA",id:"NLSValueJA",className:"form-control"},{type:"text",visible:!0,fieldName:"inputKO",id:"NLSValueKO",className:"form-control"},{type:"text",visible:!0,fieldName:"inputRU",id:"NLSValueRU",className:"form-control"},{type:"text",visible:!0,fieldName:"inputZH",id:"NLSValueZH",className:"form-control"}];r=i.createTable({alertContainer:l,wrapper:o,headersDef:d,fieldsDef:h,caption:a.tableCaption}),this.formModal(s,l,t,e.attrType,e.grid,e.changeGridObjects)}}})),define("DS/IPClassificationAttributes/CreateNewAttributes",["UWA/Class","DS/Controls/ModalContainer","DS/Controls/Loader","UWA/Promise","DS/IPClassificationAttributes/views/AttrCreateForm","i18n!DS/IPClassificationAttributes/assets/nls/IPClassificationAttributes","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUXUtil/FileImportPanel","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyAlert","DS/UIKIT/Mask","DS/IPClassificationAttributes/utils/AttributesUtil","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/ZipUtils","DS/IPClassificationAttributes/views/ToolsLayoutView","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json"],(function(e,t,a,i,n,r,l,s,o,u,d,c,p,m,g,f){"use strict";return e.extend({name:"IPClassificationAttributes",init:function(){JSON.parse(f)},buildToolsMenu:function(e){g.buildMenu(e)},loadAttrCreatePanel:function(e){var s=this;this.loader=new a({text:r.Loading,showButtonFlag:!1}),t.createModal(widget.body,this.loader.elements.container),s.loader.on(r.Loading),p.initURLSAsync().then((function(){s.tenantUrl=p.get3DSpaceUrl(),i.all([l.getPredicates({tenantUrl:s.tenantUrl}).promise,l.getDimensions({tenantUrl:s.tenantUrl}).promise]).then((function(a){t.removeModal(widget.body),n.launchPanel({attrType:e.attrType,header:r.get("HeaderPopupCreateAttr_"+e.attrType),container:e.container,predicates:a[0],dimensions:a[1].results,changeGridObjects:e.changeGridObjects,grid:e.grid})}),(function(e){u.displayNotification({message:e,className:"error"}),t.removeModal(widget.body)}))}))}})}));